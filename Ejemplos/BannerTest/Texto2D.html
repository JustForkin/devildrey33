<!-- 
    Pequeño test para crear texto en 2d dentro de una escena del THREE.js creado por Josep Antoni Bover Comas el 08-08-2016

        Vista por defecto en el Laboratorio de pruebas  
		devildrey33_Lab->Opciones->Vista = Filas;

        Ultima modificación el 08/08/2016
-->
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv='Content-Type' content='text/html; charset=utf-8' />
        <!-- Estilos CSS para el test -->
        <link rel='stylesheet' href='/Ejemplos/BannerTest/BannerTest.css' />        
        <!-- Si deseas utilizar JQuery descomenta la siguiente línea -->
<!--        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script> -->
        <!-- Three.JS -->
        <script src="/Web/JS/3rdParty/three-0.79.min.js"></script>
        <!-- ObjetoCanvas similar al ObjetoBanner para testear Banners -->
        <script src="/Ejemplos/Utils/ObjetoCanvas.js"></script>
        <!-- Código javascript --> 
<script type="text/javascript">
/* Plantilla para crear banners animados en devildrey33.es */
var ObjetoCanvas_Depurar = false; // Si es true, no se parará la animación al perder el foco del teclado

// Constructor SIN TIPO, el tipo se especifica según la animación
var Texto2D = function() {
    // Llamo al constructor del ObjetoBanner
    if (ObjetoCanvas.call(this, { 
        'Tipo'          : 'THREE',
        'Ancho'         : 'Auto',
        'Alto'          : 'Auto',
        'Entorno'       : 'Normal',
        'MostrarFPS'    : true,
        'ElementoRaiz'  : document.body
    }) === false) { return false; }
    // Se ha creado el canvas, inicio los valores de la animación ... 
    this.Escena = new THREE.Scene();
    this.Camara = new THREE.PerspectiveCamera(75, this.Ancho / this.Alto, 0.5, 1000);
    this.Camara.position.set(0, 0, 20);
    this.Escena.add(this.Camara);
    
    // Parrilla para iniciar la plantilla (se puede eliminar)
    this.Parrilla = new THREE.GridHelper(10, 10, new THREE.Color(0xcccccc), new THREE.Color(0x999999));
    this.Parrilla.position.y = -4;
    this.Escena.add(this.Parrilla);
    
    // Valores para la rotación de la cámara
    this.Rotacion_Grados    = 0;
    this.Rotacion_Avance    = 0.005;
    this.Rotacion_Distancia = 20;
    this.Camara.position.set(0, 0, this.Rotacion_Distancia);
    
    // Texto 2d
    this.CanvasTexto = document.createElement("canvas");
    this.CanvasTexto.setAttribute("width", 512);
    this.CanvasTexto.setAttribute("height", 64);
    this.CanvasTextoContext = this.CanvasTexto.getContext("2d");
    this.CanvasTextoContext.font = "normal 50px monospace";
    this.CanvasTextoContext.fillStyle = "rgba(255,0,0,0.95)";
    this.CanvasTextoContext.fillText('Texto de prueba', 0, 40);
    
    this.TexturaTexto = new THREE.Texture(this.CanvasTexto);
    this.TexturaTexto.needsUpdate = true;

    var Mat = new THREE.MeshBasicMaterial( {map: this.TexturaTexto, side:THREE.DoubleSide } );
//    Mat.transparent = true;
    
    this.PlanoTexto = new THREE.Mesh(new THREE.PlaneGeometry(80, 10), Mat);
    this.PlanoTexto.scale.set(0.2, 0.2, 0.2);
    this.Escena.add( this.PlanoTexto );    
    
    // Esconde la ventana que informa al usuario de que se está cargando la animación. (REQUERIDO)
    this.Cargando(false);
};

Texto2D.prototype = Object.assign( Object.create(ObjetoCanvas.prototype) , {
    constructor     : Texto2D, 
    // Función que se llama al redimensionar el documento
    Redimensionar   : function() {    },
    // Función que se llama al hacer scroll en el documento    
    Scroll          : function() {    },
    // Función que se llama al mover el mouse por el canvas
    MouseMove       : function(X, Y) { },
    // Función que pinta cada frame de la animación
    Pintar          : function() {  
        this.Rotacion_Grados += this.Rotacion_Avance;
        this.Camara.position.x = this.Rotacion_Distancia * Math.cos(this.Rotacion_Grados);
        this.Camara.position.z = this.Rotacion_Distancia * Math.sin(this.Rotacion_Grados);
        this.Camara.lookAt(this.Escena.position);
        this.Context.render(this.Escena, this.Camara);  
    }
});

var Canvas = null;
window.addEventListener('load', function() { Canvas = new Texto2D; });
</script>
    </head>
    <body>
    </body>
</html>