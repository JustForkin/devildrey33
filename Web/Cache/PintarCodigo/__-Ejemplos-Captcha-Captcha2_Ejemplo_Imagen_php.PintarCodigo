<div class='Codigo_Marco' id='ID1'><div class='Codigo_Titulo'>Archivo php que genera la imagen del captcha</div><div class='Codigo_Numeracion'>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br></div><pre class='Codigo_PRECodigo'><div l=1><span class='TxtNegro'>&lt;?php</span></div><div l=2><span class='TxtNegro'>    <span class='TxtAzul'>session_start</span>();</span></div><div l=3><span class='TxtNegro'>    </span></div><div l=4><span class='TxtNegro'>    <span class='TxtGris'>// Creo los valores aleatorios y guardo el resultado</span></span></div><div l=5><span class='TxtNegro'>    <span class='TxtMarron'>$Valor1</span> = <span class='TxtAzul'>rand</span>(<span class='TxtRosa'>1</span>,<span class='TxtRosa'>99</span>);</span></div><div l=6><span class='TxtNegro'>    <span class='TxtMarron'>$Valor2</span> = <span class='TxtAzul'>rand</span>(<span class='TxtRosa'>1</span>,<span class='TxtRosa'>99</span>);</span></div><div l=7><span class='TxtNegro'>    <span class='TxtMarron'>$_SESSION</span>[<span class='TxtAmarillo'>"ResultadoCaptcha"</span>] = <span class='TxtMarron'>$Valor1</span> + <span class='TxtMarron'>$Valor2</span>;</span></div><div l=8><span class='TxtNegro'>    </span></div><div l=9><span class='TxtNegro'>    <span class='TxtGris'>// Creo una imagen vacia de 120x30 a la que pintaremos el fondo transparente y los valores en negro</span></span></div><div l=10><span class='TxtNegro'>    <span class='TxtMarron'>$Imagen</span> = <span class='TxtAzul'>imagecreatetruecolor</span>(<span class='TxtRosa'>120</span>, <span class='TxtRosa'>30</span>);</span></div><div l=11><span class='TxtNegro'>    <span class='TxtMarron'>$Color_Fondo</span> = <span class='TxtAzul'>imagecolorallocate</span>(<span class='TxtMarron'>$Imagen</span>, <span class='TxtRosa'>255</span>, <span class='TxtRosa'>255</span>, <span class='TxtRosa'>255</span>);</span></div><div l=12><span class='TxtNegro'>    <span class='TxtAzul'>imagefill</span>(<span class='TxtMarron'>$Imagen</span>, <span class='TxtRosa'>0</span>, <span class='TxtRosa'>0</span>, <span class='TxtMarron'>$Color_Fondo</span>);</span></div><div l=13><span class='TxtNegro'>    <span class='TxtMarron'>$Color_Texto</span> = <span class='TxtAzul'>imagecolorallocate</span>(<span class='TxtMarron'>$Imagen</span>, <span class='TxtRosa'>0</span>, <span class='TxtRosa'>0</span>, <span class='TxtRosa'>0</span>);</span></div><div l=14><span class='TxtNegro'>    <span class='TxtAzul'>imagestring</span>(<span class='TxtMarron'>$Imagen</span>, <span class='TxtRosa'>4</span>, <span class='TxtRosa'>5</span>, <span class='TxtRosa'>5</span>,  <span class='TxtMarron'>$Valor1</span>.<span class='TxtAmarillo'>" + "</span>.<span class='TxtMarron'>$Valor2</span>.<span class='TxtAmarillo'>" ="</span>, <span class='TxtMarron'>$Color_Texto</span>);</span></div><div l=15><span class='TxtNegro'>    </span></div><div l=16><span class='TxtNegro'>    <span class='TxtGris'>// Cabecera para la imagen PNG</span></span></div><div l=17><span class='TxtNegro'>    <span class='TxtAzul'>header</span>(<span class='TxtAmarillo'>'Content-Type: image/png'</span>);</span></div><div l=18><span class='TxtNegro'>    </span></div><div l=19><span class='TxtNegro'>    <span class='TxtGris'>// Imprimo la imagen</span></span></div><div l=20><span class='TxtNegro'>    <span class='TxtAzul'>imagepng</span>(<span class='TxtMarron'>$Imagen</span>);</span></div><div l=21><span class='TxtNegro'>    </span></div><div l=22><span class='TxtNegro'>    <span class='TxtGris'>// Liberar memoria</span></span></div><div l=23><span class='TxtNegro'>    <span class='TxtAzul'>imagedestroy</span>(<span class='TxtMarron'>$Imagen</span>);</span></div><div l=24><span class='TxtNegro'>?&gt;</span></div><div l=25><span class='TxtNegro'></span></div></pre></div>