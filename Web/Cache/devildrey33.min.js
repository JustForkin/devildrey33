function RandInt(Max,Min){return Math.floor(Rand(Max,Min));}
function Rand(Max,Min){var min=(typeof(Min)!=="undefined")?Min:0;var max=(typeof(Max)!=="undefined")?Max:1;return min+Math.random()*(max-min);}
function CInt(Decimal){return Math.floor(Decimal);}
$Base=new function(){this.Entrada=[];this.Estado_Log=0;this.Ticks_Log=0;this.JSDinamico=[];this.CSSDinamico=[];this.PosPrevNext=-2;this.PosPrevNext_Tipo=0;this.PeticionAjax=0;this.Ancla;this.TemporizadorAncla=0;this.FuncionCargarCSS=function(){};this.FuncionCargarJS=function(){};this.FPL=function(){};this.Raiz="";this.RaizRelativa="";this.PosBanner=0;this.TimerTiempoSesion=0;this.ResetearTimerTiempoSesion=function(){};this.Iniciar=function(){$(".Lab_BotonVerFilas").click(function(e){$Lab.AjustarVista("0");});$(".Lab_BotonVerColumnas").click(function(e){$Lab.AjustarVista("1");});$(".Lab_BotonVerCodigo").click(function(e){$Lab.AjustarVista("2");});$(".Lab_BotonVerPreview").click(function(e){$Lab.AjustarVista("3");});$Lab.EnlazarEventosExplorador();$("#BarraPrincipal_Boton_Estado").click(function(e){$Base.ClickMenu(0);});$("#BarraPrincipal_BotonCSS_Estado").click(function(e){$Base.ClickMenu(1);});$("#BarraPrincipal_BotonCPP_Estado").click(function(e){$Base.ClickMenu(2);});$("#BarraPrincipal_BotonJS_Estado").click(function(e){$Base.ClickMenu(3);});$("#BarraPrincipal_BotonPHP_Estado").click(function(e){$Base.ClickMenu(4);});$("#BarraPrincipal_BotonBuscar_Estado").click(function(e){$Base.ClickMenu(5);});$("#BarraNavegacion_BotonVer_Estado").click(function(e){$Base.ClickMenu(6);});$("#BarraNavegacion_BotonExplorar_Estado").click(function(e){$Base.ClickMenu(7);});$("#BarraNavegacion_Indice_Estado").click(function(e){$Base.ClickMenu(9);});$("#BarraNavegacion_PrevNext_Estado").click(function(e){$Base.ClickMenu(10);});$("#BarraNavegacion_RedesSociales_Estado").click(function(e){$Base.ClickMenu(11);});$("#BarraNavegacion_Votacion_Estado").click(function(e){$Base.ClickMenu(12);});$("#BarraPrincipal_MarcoBuscar_BotonBuscar").click(function(e){$Base.Buscar();});$("#BarraPrincipal_MarcoBuscar_Edit").keyup(function(e){if(event.which===13){$Base.Buscar();}});$("#BarraNavegacion_MarcoNextPrev_Prev").click(function(e){$Base.BotonVerSiguiente();});$("#BarraNavegacion_MarcoNextPrev_Desc").click(function(e){$Base.CargarURL($("#BarraNavegacion_MarcoNextPrev_Desc").attr("Path"));});$("#BarraNavegacion_MarcoNextPrev_Next").click(function(e){$Base.BotonVerAnterior();});$("#BarraNavegacion_MarcoRedesSociales_Facebook").click(function(e){$Base.BotonFacebook();});$("#BarraNavegacion_MarcoRedesSociales_Twitter").click(function(e){$Base.BotonTwitter();});$("#BarraNavegacion_MarcoRedesSociales_GooglePlus").click(function(e){$Base.BotonGooglePlus();});this.Entrada=this.IdentificarEntrada(document.location.pathname,document.location.pathname);window.history.replaceState(this.Entrada,this.Entrada["Titulo"],document.location.pathname);$('#BarraNavegacion > a').click(function(e){e.preventDefault();e.stopImmediatePropagation();$Base.CargarURL($(this).attr("href"));return false;});$('#BarraPrincipal > #BarraPrincipal_Submenus a').click(function(e){console.log("Base.(#BarraPrincipal > #BarraPrincipal_Submenus a).Click");e.preventDefault();e.stopImmediatePropagation();$Base.ClickMenu(0);$Base.CargarURL($(this).attr("href"));return false;});$("#Logo > div:nth-child(5)").dblclick(function(e){if($Base.Estado_Log===0){$Base.Ticks_Log=$Base.GetTickCount();$Base.Estado_Log=1;setTimeout(function(){$Base.Estado_Log=0;},1500);}});$("#Logo > div:nth-child(11)").dblclick(function(e){if($Base.Estado_Log===1){console.log("Tiempo de los clicks : "+parseInt($Base.GetTickCount()-$Base.Ticks_Log)+" milisegundos.");$Base.MostrarLogin();}});$("#devildrey33_Usuario").keyup(function(e){switch(e.keyCode){case 27:$("#VentanaLogin").attr({"Visible":"false"});break;case 13:$("#devildrey33_Password").focus();break;}});$("#devildrey33_Password").keyup(function(e){switch(e.keyCode){case 27:$("#VentanaLogin").attr({"Visible":"false"});break;case 13:$Base.Loguear();break;}});$("#ErroresPHP_Cerrar").click(function(e){$("#ErroresPHP").attr({"mostrar":false});});this.RedireccionarLinks();if(typeof localStorage["Comentarios_Usuario"]!=='undefined'){$("#devildrey33_Usuario").val(localStorage["Comentarios_Usuario"]);}};this.MostrarLogin=function(FuncionPostLogin){if(typeof(FuncionPostLogin)!=="undefined")this.FPL=FuncionPostLogin;$("#VentanaLogin").attr({"Visible":"true"});setTimeout(function(){if(typeof localStorage["Comentarios_Usuario"]==='undefined'){$("#devildrey33_Usuario").focus();}
else{$("#devildrey33_Password").focus();}},200);};this.Banner=function(Pos){if($Banner!==null){window.cancelAnimationFrame($Banner.RAFID);}
var Banner_Lista=[Banner_ResplandorCircular,Banner_Colisiones,Banner_TranstornoLineal,Banner_Espacio2D,Banner_MatrixLluviaHexadecimal,Banner_AdiestramientoCubos3D,Banner_WormHole,Banner_Anillos,Banner_Sinusoidal];var fPos=0;if(typeof(Pos==="undefined")){fPos=RandInt(Banner_Lista.length);}
else{fPos=Pos}
if(Pos===-1){fPos=this.PosBanner-1;if(fPos<0){fPos=(Banner_Lista.length)-1;}}
else if(Pos===-2){fPos=this.PosBanner+1;if(fPos>=(Banner_Lista.length)){fPos=0;}}
console.log("Base.Banner(Pos = "+Pos+")",fPos);this.PosBanner=fPos;$Banner=new Banner_Lista[fPos];};this.MostrarErroresPHP=function(){console.log("Base.MostrarErroresPHP");$EFP=$("#ErroresFinPlantilla").html();if($EFP!==""){$("#ErroresFinPlantilla").html("");$("#ErroresPHP_Info").html($EFP);}
$("#ErroresPHP").attr({"mostrar":true});};this.BotonTwitter=function(){Texto=$("#Cabecera > .Cabecera_Datos > h1").html();console.log("Base.BotonTwitter",Texto,window.location.href);window.open("http://twitter.com/home?status="+Texto+": "+window.location.href,"Twitter","toolbar=no,width=550,height=255");};this.BotonFacebook=function(){Texto=$("#Cabecera > .Cabecera_Datos > h1").html();console.log("Base.BotonFacebook",Texto,window.location.href);window.open("http://www.facebook.com/share.php?u="+window.location.href+"&t="+Texto,"Facebook","toolbar=no,width=550,height=355");};this.BotonGooglePlus=function(){Texto=$("#Cabecera > .Cabecera_Datos > h1").html();console.log("Base.BotonGooglePlus",Texto,window.location.href);window.open("https://plus.google.com/share?url="+window.location.href+"&t="+Texto,"Google Plus","toolbar=no,width=550,height=355");};this.BotonLinkEdin=function(){Texto=$("#Cabecera > .Cabecera_Datos > h1").html();console.log("Base.BotonLinkEdin",Texto,window.location.href);};this.Debug=(function(){var Consola=console;return function(Valor,Limpiar){var nLimpiar=Limpiar||false;if(Valor===false){console={};console.log=function(){};if(nLimpiar){console.info=function(){};console.warn=function(){};console.error=function(){};}else{console.info=Consola.info;console.warn=Consola.warn;console.error=Consola.error;}}
else{console=Consola;}};})();this.ClickMenu=function(Menu){console.log("Base.ClickMenu",Menu);if(Menu!==1){$("#BarraPrincipal_BotonCSS_Estado").removeAttr("checked");}
if(Menu!==2){$("#BarraPrincipal_BotonCPP_Estado").removeAttr("checked");}
if(Menu!==3){$("#BarraPrincipal_BotonJS_Estado").removeAttr("checked");}
if(Menu!==4){$("#BarraPrincipal_BotonPHP_Estado").removeAttr("checked");}
if(Menu!==5){$("#BarraPrincipal_BotonBuscar_Estado").removeAttr("checked");}
if(Menu===5){$("#BarraPrincipal_MarcoBuscar_Edit").focus().select();}
if(Menu!==6){$("#BarraNavegacion_BotonVer_Estado").removeAttr("checked");}
if(Menu!==7){$("#BarraNavegacion_BotonExplorar_Estado").removeAttr("checked");}
if(Menu!==8){$("#BarraPrincipal_Boton33_Estado").removeAttr("checked");}
if(Menu!==9){$("#BarraNavegacion_Indice_Estado").removeAttr("checked");}
if(Menu===8){$("#BarraPrincipal_Boton_Estado").removeAttr("checked");}
if(Menu!==10){$("#BarraNavegacion_PrevNext_Estado").removeAttr("checked");}
if(Menu!==11){$("#BarraNavegacion_RedesSociales_Estado").removeAttr("checked");}
if(Menu!==12){$("#BarraNavegacion_Votacion_Estado").removeAttr("checked");}};this.GetTickCount=function(){var d=new Date();return d.getTime();};this.RedireccionarLinks=function(){console.log("Base.RedireccionarLinks");$("#MarcoNavegacion a[href]:not([target])").off("click").on("click",function(e){e.preventDefault();e.stopImmediatePropagation();$Base.CargarURL($(this).attr("href"));return false;});Pagina=$("#MarcoNavegacion > article").attr("pagina");$("#BarraNavegacion_Votacion").removeAttr("Mostrar");this.ComprobarScrollVotacion();$PintarCodigo.EnlazarEtiquetas();this.ActualizarBarraNavegacion();$Lab.MiniLab_Iniciar();this.LogoCargando("FALSE");};this.VotarWeb=function(Valor){Pagina=$("#MarcoNavegacion > article").attr("pagina");$("#BarraNavegacion_Votacion_Estado").removeAttr("checked");console.log("Base.VotarWeb",Valor,Pagina);if(typeof localStorage["Voto_"+Pagina]==="undefined"){localStorage["Voto_"+Pagina]=Valor;$.post(this.Raiz+"cmd/VotarPagina.cmd",{"Pagina":Pagina,"Valor":Valor,"URL":window.location.href}).done(function(data){Datos=JSON.parse(data);if(Datos["HTML"]!=="false"){$(".Cabecera_Datos > .FechaEntrada > span").html(Datos["HTML"]);$("#BarraNavegacion_Votacion").removeAttr("Mostrar");if($("html").attr("lang")==="es"){$Base.MostrarMensaje("La votación se ha relaizado correctamente, muchas gracias!");}
else{$Base.MostrarMensaje("Your vote is annotated, thank you!");}}
$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}}).fail(function(jqXHR,textStatus,tError){console.log("Base.VotarWeb Error ajax",jqXHR,textStatus,tError);$Base.MostrarErrorAjax(jqXHR.status,false,tError);});}
else{if($("html").attr("lang")==="es"){$Base.MostrarMensaje("Solo puedes votar una vez por página.");}
else{$Base.MostrarMensaje("Only you can vote one time per page.");}}};this.MostrarMensaje=function(Mensaje,Titulo,Alerta,Funcion){console.log("Base.MostrarMensaje("+Mensaje+")");if(typeof(Alerta)==="undefined"){Alerta="false";}
else{if(typeof(Titulo)==="undefined"){Titulo="Mensaje de alerta";}}
if(typeof(Titulo)==="undefined"){Titulo="Mensaje";}
if(typeof(Funcion)==="undefined"){Funcion=function(){};}
Ventana=$("<div class='VentanaMensaje MarcoVentana-350' visible='false' alerta='"+Alerta+"' titulo='"+Titulo+"'>"+"<p>"+Mensaje+"</p>"+"<div class='Centrado'>"+"<button class='BotonVentana'>Aceptar</button>"+"</div>"+"</div>");Ventana.find(".Centrado > button").on("click",{"Funcion":Funcion},function(event){$(this).parent().parent().attr({"visible":"false"});event.data.Funcion();setTimeout(function(Ventana){Ventana.remove();},500,$(this).parent().parent());});Ventana.appendTo('body').attr({"visible":"false"});setTimeout(function(Ventana){Ventana.attr({"visible":"true"}).find("button").focus();},100,Ventana);};this.MostrarErrorAjax=function(Error,VolverIndice,Excepcion){console.log("Base.MostrarErrorAjax("+Error+", "+VolverIndice+")");this.LogoCargando("FALSE");this.Cargando("FALSE");switch(Error){case 403:Mensaje="Error 403 en la petición ajax.<br />No se permite el acceso al archivo solicitado.";break;case 404:Mensaje="Error 404 en la petición ajax.<br />El archivo solicitado no existe.";break;case 1404:Mensaje="Error 404 en la petición ajax.<br />No se puede cargar el ejemplo del lab.";break;default:Mensaje="Error 500 en la petición ajax.<br />Es posible que el servidor no esté disponible en estos momentos. ("+Excepcion+")";break;}
Funcion=function(){};if(VolverIndice===true){this.Entrada["TipoPagina"]="Error404";Mensaje=Mensaje+" Pulsa aceptar para ser re-dirigido al indice.";Funcion=function(){$Base.CargarURL("/");};}
this.MostrarMensaje(Mensaje,"true",Funcion);};this.IdentificarEntrada=function(iURL,URLReal){var Ret={"Titulo":"devildrey33","URL":iURL,"URLReal":URLReal,"Imagen":"","TipoPagina":"Desconocido","Pos":-2,"Idioma":"es"};if(URLReal.indexOf("Categorias/")>-1||iURL==="/"+this.RaizRelativa||iURL===this.Raiz){Ret["TipoPagina"]="Indice";$("body").attr({"Tipo":Ret["TipoPagina"]});console.log("Base.IdentificarEntrada : "+Ret["TipoPagina"],Ret);return Ret;}
nURL="";cURL=iURL.toLowerCase();if(cURL.indexOf("blog/")>-1){Ret["TipoPagina"]="Blog";nURL=iURL.substr(6);}
if(cURL.indexOf("doc/css")>-1){Ret["TipoPagina"]="DocCSS";nURL=iURL.substr(8);}
if(cURL.indexOf("lab/")>-1){Ret["TipoPagina"]="Lab";nURL="";}
if(cURL.indexOf("web/")>-1||cURL.indexOf("faqbarba")>-1){Ret["TipoPagina"]="Web";nURL="";}
$("body").attr({"Tipo":Ret["TipoPagina"]});console.log("Base.IdentificarEntrada : "+Ret["TipoPagina"],Ret);return Ret;};this.BuscarEntradaActual=function(nURL,nTitulo){for(i=0;i<EntradasBlog.length;i++){if(nURL.indexOf(EntradasBlog[i]["URL"])!==-1&&EntradasBlog[i]["Titulo"]===nTitulo){console.log("Base.BuscarEntradaActual : "+i,EntradasBlog[i]);this.Entrada["Titulo"]=EntradasBlog[i]["Titulo"];this.Entrada["Imagen"]=EntradasBlog[i]["Imagen"];this.Entrada["Idioma"]=EntradasBlog[i]["Idioma"];this.PosPrevNext_Tipo=EntradasBlog[i]["Tipo"];return i;}}
console.log("Base.BuscarEntradaActual : -1");return-1;};this.ActualizarBarraNavegacion=function(){console.log("Base.ActualizarBarraNavegacion",this.Entrada);this.EscanearAnclas();switch(this.Entrada["TipoPagina"]){case"LabError":case"Error404":case"Error404SinPlantilla":this.MostrarBarraNavegacion();break;case"Lab":$Lab.Iniciar();this.MostrarBarraNavegacion();break;case"Indice":$("#MarcoIndice").attr({"visible":true});$("#Categorias").attr({"visible":true});$Indice.Iniciar();this.OcultarBarraNavegacion();break;case"Blog":case"DocCSS":this.Banner();$Comentarios.Iniciar();this.MostrarBarraNavegacion();break;case"Web":this.MostrarBarraNavegacion();break;case"Buscar":$("#BarraNavegacion_Prev").hide();$("#BarraNavegacion_Next").hide();break;default:this.OcultarBarraNavegacion();break;}};this.CrearPrevNext=function(Pos){console.log("Base.CrearPrevNext",Pos);if(Pos>EntradasBlog.length||Pos<0)return false;$("#BarraNavegacion_MarcoNextPrev_Next").removeAttr("disabled");$("#BarraNavegacion_MarcoNextPrev_Prev").removeAttr("disabled");this.PosPrevNext=Pos;if(this.Entradas_BuscarSiguienteMismoTipo(Pos)===-1){$("#BarraNavegacion_MarcoNextPrev_Next").attr({"disabled":"disabled"});}
if(this.Entradas_BuscarAnteriorMismoTipo(Pos)===-1){$("#BarraNavegacion_MarcoNextPrev_Prev").attr({"disabled":"disabled"});}
Imagen="CSS3.png";if(EntradasBlog[this.PosPrevNext]["Tipo"].indexOf("DocCSS")===-1){Imagen=EntradasBlog[this.PosPrevNext]["Imagen"];}
$("#BarraNavegacion_MarcoNextPrev_Desc").html("<img src='"+this.Raiz+"Web/Graficos/155x125_"+Imagen+"' alt=''/>"+"<h3>"+EntradasBlog[this.PosPrevNext]["Titulo"]+"</h3>");$("#BarraNavegacion_MarcoNextPrev_Desc").attr({"Path":EntradasBlog[this.PosPrevNext]["URL"]});return true;};this.BotonVerSiguiente=function(){if(this.CrearPrevNext(this.Entradas_BuscarAnteriorMismoTipo(this.PosPrevNext))===false){$("#BarraNavegacion_MarcoNextPrev_Next").attr({"disabled":"disabled"});}};this.BotonVerAnterior=function(){if(this.CrearPrevNext(this.Entradas_BuscarSiguienteMismoTipo(this.PosPrevNext))===false){$("#BarraNavegacion_MarcoNextPrev_Next").attr({"disabled":"disabled"});}};this.Entradas_BuscarSiguienteMismoTipo=function(Cont){while(--Cont>-1){if(this.PosPrevNext_Tipo===EntradasBlog[Cont]["Tipo"]){if(Cont!==this.Entrada["Pos"]){return Cont;}}}
return-1;}
this.Entradas_BuscarAnteriorMismoTipo=function(Cont){while(++Cont<EntradasBlog.length-1){if(this.PosPrevNext_Tipo===EntradasBlog[Cont]["Tipo"]){if(Cont!==this.Entrada["Pos"]){return Cont;}}}
return-1;}
this.MostrarBarraNavegacion=function(){this.Entrada["Pos"]=this.BuscarEntradaActual(this.Entrada["URL"],$("#Cabecera > .Cabecera_Datos > h1").html());console.log("Base.MostrarBarraNavegacion",this.Entrada);$("html").attr({"lang":this.Entrada["Idioma"]});this.PosPrevNext=this.Entradas_BuscarSiguienteMismoTipo(this.Entrada["Pos"]);if(this.PosPrevNext==-1){this.PosPrevNext=this.Entradas_BuscarAnteriorMismoTipo(this.Entrada["Pos"]);}
$("#BarraNavegacion").attr({"Visible":true});if(this.Entrada["Pos"]!==-1){$("#BarraNavegacion_NextPrev").attr({"mostrar":"true"});}
else{$("#BarraNavegacion_NextPrev").removeAttr("mostrar");}
this.CrearPrevNext(this.PosPrevNext);};this.OcultarBarraNavegacion=function(){$("#BarraNavegacion").attr({"Visible":false});};this.BuscarAncla=function(Pos){this.Ancla=$("#MarcoNavegacion h2").eq(Pos);var PosAncla=this.Ancla.offset().top;var PosScroll=$(document).scrollTop();var AltoVentana=$(window).height();console.log("Base.BuscarAncla("+Pos+")",PosAncla,AltoVentana,PosScroll);if(!(PosAncla>PosScroll-AltoVentana&&PosAncla<PosScroll+AltoVentana)){$("body, html").stop().animate({scrollTop:PosAncla-25});}
this.Ancla.attr({"resaltado":"true"});if(this.TemporizadorAncla!=0){clearTimeout(this.TemporizadorAncla);}
this.TemporizadorAncla=setTimeout(function(){$Base.Ancla.removeAttr("resaltado");$Base.TemporizadorAncla=0;},1000);};this.EscanearAnclas=function(){console.log("Base.EscanearAnclas");var Codigo="";var ContadorAnclas=0;$("#MarcoNavegacion h2").each(function(index){var Texto=$(this).html();if(Texto==""){Texto=window.getComputedStyle(this,':after').getPropertyValue('content');Texto=Texto.replace('"','').replace('"','');}
Codigo=Codigo+"<div onclick='$Base.BuscarAncla("+(ContadorAnclas++)+")' title='"+Texto+"'>"+Texto+"</div>";});var Columnas=0;while(ContadorAnclas>0){ContadorAnclas-=12;Columnas++;}
$("#BarraNavegacion_SubIndice").attr({"class":"Menu_Marco SubIndice_Columas_"+Columnas});if(Codigo!==""){$("#BarraNavegacion_Indice").show();$("#BarraNavegacion_SubIndice").html(Codigo);}
else{$("#BarraNavegacion_Indice").hide();}};this.LogoCargando=function(Valor){this.Cargando(Valor);if(Valor==="TRUE"){if(this.PeticionAjax!=0){this.PeticionAjax.abort();}
$(".VentanaMensaje").attr("Visible",false).each(function(){setTimeout(function(Ventana){Ventana.remove();},500,$(this));});$("#MarcoIndice").attr({"Visible":false});$("#Categorias").attr({"Visible":false});document.getElementById("Logo").className="AnimarLogo SinSeleccion";this.OcultarBarraNavegacion();}
else{this.PeticionAjax=0;document.getElementById("Logo").className="SinSeleccion";$("#MarcoIndice").attr({"Visible":true});$("#Categorias").attr({"Visible":true});}};this.Cargando=function(Valor){if(Valor==="TRUE"){$("#BarraNavegacion_Inferior").attr({"mostrar":true});}
else{$("#BarraNavegacion_Inferior").removeAttr("mostrar");}};this.Buscar=function(){if($("#BarraPrincipal_MarcoBuscar_Edit").val()===""){$("#BarraPrincipal_MarcoBuscar_Edit").focus();this.MostrarMensaje("Debes especificar una o mas palabras a buscar.")
return;}
console.log("Base.Buscar "+$("#BarraPrincipal_MarcoBuscar_Edit").val());this.Cargando("TRUE");$.post(this.Raiz+"cmd/Buscar",{"Palabras":$("#BarraPrincipal_MarcoBuscar_Edit").val()}).done(function(data){Datos=JSON.parse(data);$("#BarraPrincipal_MarcoBuscar_Resultado").html(Datos["HTML"]);$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}
$Base.Cargando("FALSE");$("#BarraPrincipal_MarcoBuscar a[href]:not([target])").off("click").on("click",function(e){e.preventDefault();e.stopImmediatePropagation();$Base.CargarURL($(this).attr("href"));$Base.ClickMenu(0);return false;});}).fail(function(jqXHR,textStatus,tError){console.log("Base.Buscar Error ajax",jqXHR,textStatus,tError);$Base.MostrarErrorAjax(jqXHR.status,false,tError);});};this.CargarURL=function(cURL){this.ResetearTimerTiempoSesion();if($Lab.Modificado()===true){setTimeout(function(nURL){$Base.CargarURL(nURL);},200,cURL);return;}
$("#BarraNavegacion > .Menu > input[type=checkbox]").removeAttr("checked");this.LogoCargando("TRUE");if(cURL.indexOf("/")===-1){Path=window.location.href.split('/');Path.pop();Path=Path.join('/');cURL=Path+"/"+cURL;nURL=Path+"/"+cURL;}
if(cURL==="/"+this.Raiz)nURL="/"+this.RaizRelativa+"index.php";else nURL=cURL;if(cURL.charAt(0)==='/'){nURL="/"+this.RaizRelativa+cURL.substr(1);cURL=nURL;}
console.log("Base.CargarURL "+nURL);this.cURL=cURL;this.nURL=nURL;this.PeticionAjax=$.post(nURL,{"Regenerar":"todo","Categoria":"Todo","SinPlantilla":"true"}).done(function(data){Datos=JSON.parse(data);if(Datos["HTML"].indexOf("<script>$Base.MostrarErrorAjax(404, false);</script>")===0){$Base.MostrarErrorAjax(404,false,'No se ha encontrado');}
else{$Banner=null;$("#MarcoNavegacion").html(Datos["HTML"]);$Base.Entrada=$Base.IdentificarEntrada($Base.cURL,$Base.nURL);window.history.pushState($Base.Entrada,document.title,$Base.cURL);$(window).scrollTop(0);document.title=$Base.Entrada["Titulo"];$Base.RedireccionarLinks();$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}}}).fail(function(jqXHR,textStatus,tError){console.log("Base.CargarURL Error ajax",jqXHR,textStatus,tError);$Base.MostrarErrorAjax(jqXHR.status,false,tError);});$("#VentanaError").attr({"visible":"false"});};this.Loguear=function(){var l=$("#devildrey33_Usuario").val();var p=$("#devildrey33_Password").val().split("").reverse().join("");var v;var r=parseInt(Math.random()*(9+1));var pass=r.toString();for(var i=0;i<p.length;i++){v=p.charCodeAt(i)+r;if(v>255)v-=255;rv=v.toString();if(v<10)rv="00"+rv;if(v<100&&v>10)rv="0"+rv;pass=pass+rv;}
console.log("Base.Loguear("+pass+")");this.Cargando("TRUE");$.post($Base.Raiz+"cmd/Loguear.cmd",{"l":l,"p":pass}).done(function(data,textStatus,jqXHR){Datos=JSON.parse(data);if(Datos.Estado===0){localStorage["Comentarios_Usuario"]=$("#devildrey33_Usuario").val();$("#VentanaLogin").attr({visible:false});$("#Marco33").html(Datos.HTMLAdmin);$Base.CargarJS("ObjetoAdmin.js",function(){$Admin.Iniciar();});$("#BarraNavegacion_Explorador").html(Datos.ExplorarLab);$Lab.EnlazarEventosExplorador();$Base.FPL();}
else{if(Datos.Estado===1){$("#VentanaLogin").removeClass("VentanaError_AnimacionError");setTimeout(function(){$("#VentanaLogin").addClass("VentanaError_AnimacionError");},50);}
else if(Datos.Estado===2){$Base.MostrarMensaje("Error interno del servidor...","Error grave","true");}
$Base.Cargando("FALSE");}
$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}
$Base.FPL=function(){};}).fail(function(jqXHR,textStatus,tError){console.log("Base.Loguear Error ajax",jqXHR,textStatus,tError);$Base.MostrarErrorAjax(jqXHR.status,false,tError);$Base.FPL=function(){};});};this.cmd=function(Comando){this.ResetearTimerTiempoSesion();$.post(this.Raiz+"cmd/"+Comando+".cmd").done(function(data){Datos=JSON.parse(data);console.log("Base.cmd("+Comando+")",Datos);$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}
if(Datos["Estado"]===0&&"Mensaje"in Datos){if(Datos["Mensaje"]!==""){$Base.MostrarMensaje(Datos["Mensaje"]);}}
if(Datos["Estado"]===1){$("#BarraNavegacion_Explorador").html(Datos["HTML"]);$Lab.EnlazarEventosExplorador();$('body').attr({'administrador33':false});$Base.ClickMenu(0);setTimeout(function(){$('#Marco33').html('');},500);$Base.MostrarMensaje("Error!, no eres administrador.");}}).fail(function(jqXHR,textStatus,tError){console.log("Base.cmd Error ajax",jqXHR,textStatus,tError);$Base.MostrarErrorAjax(jqXHR.status,false,tError);});};this.CargarJS=function(Nombre,Funcion){if(typeof(Funcion)!=="undefined"){this.FuncionCargarJS=Funcion;}
else{this.FuncionCargarJS=function(){};}
for(var i=0;i<this.JSDinamico.length;i++){if(this.JSDinamico[i]===Nombre){console.log("Base.CargarJS("+Nombre+") ya se había cargado...");this.FuncionCargarJS();return;}}
$.getScript("/"+this.RaizRelativa+"Web/JS/"+Nombre,function(data,textStatus,jqxhr){console.log("Base.CargarJS("+Nombre+")");$Base.FuncionCargarJS();}).fail(function(jqxhr,settings,exception){console.log("Base.CargarJS Error Ajax",jqxhr,settings,exception);$Base.MostrarErrorAjax(jqxhr.status,false,exception);});};this.CargarCSS=function(Nombre){for(var i=0;i<this.CSSDinamico.length;i++){if(this.CSSDinamico[i]===Nombre){console.log("Base.CargarCSS("+Nombre+") ya se había cargado...");return;}}
this.CSSDinamico.push(Nombre);var Script=document.createElement("link");Script.setAttribute("rel","stylesheet");Script.setAttribute("type","text/css");Script.setAttribute("href","/"+this.RaizRelativa+"Web/CSS/"+Nombre);if(typeof Script!=="undefined")document.getElementsByTagName("head")[0].appendChild(Script);console.log("Base.CargarCSS("+Nombre+")");};this.CALLBACK_Histroial=function(event){this.ResetearTimerTiempoSesion();if($Lab.Modificado()===true){setTimeout(function(nURL){$Base.CALLBACK_Histroial(event);},200,event);return;}
this.LogoCargando("TRUE");console.log("Base.CALLBACK_Histroial",event.state);if(event.state){cURL=event.state["URL"];}
else{cURL=window.location.href;}
cURL.replace("..","");if(cURL.indexOf("/")===-1){Path=window.location.href.split('/');Path.pop();Path=Path.join('/');cURL=Path+"/"+cURL;nURL=Path+"/"+cURL;}
if(cURL==="/")nURL="/index.php";else nURL=cURL;this.PeticionAjax=$.post(nURL,{"Regenerar":"todo","Categoria":"Todo","SinPlantilla":"true"}).done(function(data){Datos=JSON.parse(data);if(Datos["HTML"].indexOf("<script>$Base.MostrarErrorAjax(404, false);</script>")===0){$Base.MostrarErrorAjax(404,"false");}
else{$Banner=null;$("#MarcoNavegacion").html(Datos["HTML"]);$Base.Entrada=$Base.IdentificarEntrada(cURL,nURL);$Base.RedireccionarLinks();document.title=$Base.Entrada["Titulo"];}
$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}}).fail(function(jqXHR,textStatus,tError){console.log("Base.CALLBACK_Histroial Error ajax",jqXHR,textStatus,tError);$Base.MostrarErrorAjax(jqXHR.status,false,tError);});$("#VentanaError").attr({"visible":"false"});};this.ErrorJS=function(e){var ErrorStr="%cTipo     : %c"+e.type+"\n%cError    : %c"+e.error+"\n%cArchivo  : %c"+e.filename.substring(e.filename.lastIndexOf('/')+1)+"\n%cPath     : %c"+e.filename+":"+e.lineno+"\n%cLínea    : %c"+e.lineno+"\n%cCaracter : %c"+e.colno+"\n%cFecha    : %c"+new Date();console.log(ErrorStr,"font-weight: bold;","color: #e74c3c;","font-weight: bold;","font-weight: normal; color: #e74c3c;","font-weight: bold;","font-weight: normal;","font-weight: bold;","font-weight: normal; color: #3498db;","font-weight: bold;","font-weight: normal;","font-weight: bold;","font-weight: normal;","font-weight: bold;","font-weight: normal;");};this.ComprobarScrollVotacion=function(){if(typeof localStorage["Voto_"+$("#MarcoNavegacion > article").attr("pagina")]==="undefined"){if(typeof($("#Comentarios_Datos").offset())!=="undefined"){FinalPagina=$("#Comentarios_Datos").offset().top;}
else{FinalPagina=$(document).height();}
if($(window).scrollTop()>FinalPagina-($(window).height()*2)){console.log("Base.ComprobarScrollVotacion");Pagina=$("#MarcoNavegacion > article").attr("pagina");if(typeof localStorage["Voto_"+Pagina]==="undefined"){$("#BarraNavegacion_Votacion").attr({"mostrar":"true"});$("#BarraNavegacion_Votacion .VotarDocumento_Estrellas > button").off("click").on("click",function(e){$Base.VotarWeb($(this).html());});}}}};};Date.prototype.toDateInputValue=(function(){var local=new Date(this);local.setMinutes(this.getMinutes()-this.getTimezoneOffset());return local.toJSON().slice(0,10);});window.addEventListener('popstate',function(event){$Base.CALLBACK_Histroial(event);},false);window.addEventListener('error',function(e){$Base.ErrorJS(e);});$(window).on("load",function(){$Base.Iniciar();});$(window).on("scroll",function(){$Base.ComprobarScrollVotacion();});
$Indice=new function(){this.Cargando=false;this.TotalArticulosCargados=0;this.Iniciar=function(){console.log("Indice.Iniciar");$("#Categorias > div > div").off("click").on("click",function(e){$Base.CargarURL($(this).attr("path"));});};this.ComprobarScroll=function(){if($("#MarcoIndice > div[finscrollinfinito]").length===0&&this.Cargando===false&&$("#MarcoIndice").length!==0){if($(window).scrollTop()>($(document).height()-($(window).height()*2))){console.log("Indice.ComprobarScroll",$("#MarcoIndice > div[finscrollinfinito]").length);this.Cargando=true;$Base.Cargando("TRUE");this.TotalArticulosCargados=$("#MarcoIndice > .Articulo_Portada").length;nAjax=$.post($Base.Raiz+"cmd/IndiceObtener15Mas.cmd",{"Categoria":$("#Categorias").attr("categoria"),"Inicio":this.TotalArticulosCargados});nAjax.done(function(data){Datos=JSON.parse(data);$("div[puntoscroll=true]").removeAttr("puntoscroll");$("#MarcoIndice").html($("#MarcoIndice").html()+Datos["HTML"]);$Base.Cargando("FALSE");$Indice.Cargando=false;$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}});nAjax.fail(function(jqXHR,textStatus,tError){console.log("Indice.ComprobarScroll Error ajax",jqXHR,textStatus,tError);$Indice.Cargando=false;$Base.MostrarMensaje("Error cargando los 10 siguientes articulos");$Base.Cargando("FALSE");});}}};};$(window).scroll(function(){$Indice.ComprobarScroll();});
$Comentarios=new function(){this.NumComentario=0;this.Obteniendo=false;this.MostrarComentarioTimer=0;this.Enviando=false;this.Iniciar=function(){console.log("Comentarios.Iniciar");$("#Comentarios_Datos span[comentario]").off("click").on("click",function(){$Comentarios.MostrarComentario($(this).attr("comentario"));});$("#Comentarios_Comentario").on('blur keyup paste copy cut mouseup',function(){$Comentarios.AsignarEstadosBotones();});$('#Comentarios_Comentario').on('paste',function(e){e.preventDefault();var Ret=$("<div></div>").append((e.originalEvent||e).clipboardData.getData('text/html'));Ret.find('*').each(function(){if($(this).get(0).tagName==='SCRIPT'||$(this).get(0).tagName==='BUTTON'){$(this).remove();}
if($(this).get(0).tagName==='A'){$(this).attr({"target":"_blank"})}});$Comentarios.ComandoEdicion("insertHTML",Ret.html());});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(1)").off("mouseup").on("mouseup",function(){$Comentarios.ComandoEdicion("bold");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(2)").off("mouseup").on("mouseup",function(){$Comentarios.ComandoEdicion("underline");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(3)").off("mouseup").on("mouseup",function(){$Comentarios.ComandoEdicion("italic");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(4)").off("mouseup").on("mouseup",function(){$Comentarios.ComandoEdicion("strikethrough");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(5)").off("mouseup").on("mouseup",function(){$Comentarios.ComandoEdicion("undo");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(6)").off("mouseup").on("mouseup",function(){$Comentarios.ComandoEdicion("redo");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(7)").off("mouseup").on("mouseup",function(){$Comentarios.ComandoEdicion("insertunorderedlist");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(8)").off("mouseup").on("mouseup",function(){$Comentarios.ComandoEdicion("insertorderedlist");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(9)").off("mouseup").on("mouseup",function(){$Comentarios.ComandoEdicion("removeFormat");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(10)").off("mouseup").on("mouseup",function(){$Comentarios.ComandoEdicion("justifyLeft");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(11)").off("mouseup").on("mouseup",function(){$Comentarios.ComandoEdicion("justifyCenter");});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(12)").off("mouseup").on("mouseup",function(){$Comentarios.ComandoEdicion("justifyRight");});$("#Comentarios > .Centrado > button").off("click").on("click",function(){$Comentarios.BotonEnviarComentario();});$("#Comentarios_Datos > div[comentario]").off("click").on("click",function(evento){$Comentarios.SeleccionarComentario($(this));});if(typeof localStorage["Comentarios_Usuario"]!=="undefined"){$("#Comentarios_Nombre").val(localStorage["Comentarios_Usuario"]);}
if(typeof localStorage["Comentarios_Correo"]!=="undefined"){$("#Comentarios_Correo").val(localStorage["Comentarios_Correo"]);}
if(typeof localStorage["Comentarios_Web"]!=="undefined"){$("#Comentarios_Web").val(localStorage["Comentarios_Web"]);}
this.EnlazarBotonesMensajes();$("#Comentarios_Comentario").html("");this.Obteniendo=false;if($("html").attr("lang")==="es"){$("#Comentarios > #Comentarios_Comentario + button").html("Enviar comentario");}
else{$("#Comentarios > #Comentarios_Comentario + button").html("Send comment");}};this.EnlazarBotonesMensajes=function(){$("div[comentario] > .Comentarios_ControlesMensaje > button:nth-child(1)").off("click").on("click",function(evento){$Comentarios.BotonResponder(this);});$("div[comentario] > .Comentarios_ControlesMensaje > button:nth-child(2)").off("click").on("click",function(evento){$Comentarios.VotarComentario(this,1);});$("div[comentario] > .Comentarios_ControlesMensaje > button:nth-child(3)").off("click").on("click",function(evento){$Comentarios.VotarComentario(this,0);});$("div[comentario] > .Comentarios_ControlesMensaje > button:nth-child(4)").off("click").on("click",function(evento){$Admin.Comentarios_BotonEditarComentario(this);});$("div[comentario] > .Comentarios_ControlesMensaje > button:nth-child(5)").off("click").on("click",function(evento){$Admin.Comentarios_BotonEliminarComentario(this);});$("div[comentario] > .Comentarios_ControlesMensaje > button:nth-child(6)").off("click").on("click",function(evento){$Admin.Comentarios_VerEmail(this);});};this.BotonResponder=function(Boton){NumC=$(Boton).parent().parent().attr("comentario");this.InsertarHTML("<span comentario='"+NumC+"' contenteditable='false'>"+NumC+"</span>&nbsp;");};this.VotarComentario=function(Boton,Valor){Pagina=$("#MarcoNavegacion > article.Blog").attr("pagina");NumC=$(Boton).parent().parent().attr("comentario");LCSTR="Votaciones_"+Pagina+"_"+NumC;if(typeof localStorage[LCSTR]!=="undefined"){console.log("Comentarios.VotarComentario (ya has votado)");$Base.MostrarMensaje("No puedes votar el mismo mensaje 2 veces.");return;}
else{localStorage[LCSTR]=true;}
$Base.Cargando("TRUE");console.log("Comentarios.BotonMasUno");nAjax=$.post($Base.Raiz+"cmd/VotarComentario.cmd",{"Pagina":Pagina,"NumComentario":NumC,"Valor":Valor}).done(function(data){Datos=JSON.parse(data);if(Datos.Mensaje==="Correcto"){nValor=$("#Comentarios_Datos > div[comentario="+Datos.NumComentario+"] > div:nth-child(2) > span > b:nth-child(1)");nTotal=$("#Comentarios_Datos > div[comentario="+Datos.NumComentario+"] > div:nth-child(2) > span > b:nth-child(2)");nValor.html(parseInt(nValor.html())+Datos.Valor);nTotal.html(parseInt(nTotal.html())+1);}
else{$Base.MostrarMensaje(data.Mensaje);}
$Base.Cargando("FALSE");$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}}).fail(function(jqXHR,textStatus,tError){console.log("Comentarios.VotarComentario Error ajax",jqXHR,textStatus,tError);$Base.MostrarMensaje("Error al tramitar la votación.");$Base.Cargando("FALSE");});};this.SeleccionarComentario=function(Comentario){console.log("Comentarios.SeleccionarComentario");$("#Comentarios_Datos > div[comentario][seleccionado=true]").removeAttr("seleccionado");Comentario.attr({"seleccionado":true});};this.BotonEnviarComentario=function(){if(this.Enviando===true)return;console.log("Comentarios.EnviarComentario",$("#Comentarios_Correo").css("border-color"));if($("#Comentarios_Nombre").css("border-color")==="rgb(176, 53, 53)"){$Base.MostrarMensaje("Debes introducir un nombre válido.");return false;}
if($("#Comentarios_Correo").css("border-color")==="rgb(176, 53, 53)"){$Base.MostrarMensaje("La dirección de correo introducida no es válida.");return false;}
if($("#Comentarios_Comentario").html()===""){$Base.MostrarMensaje("El mensaje está vacio!");return false;}
this.Enviando=true;$Base.ResetearTimerTiempoSesion();$Base.Cargando("TRUE");localStorage["Comentarios_Usuario"]=$("#Comentarios_Nombre").val();localStorage["Comentarios_Correo"]=$("#Comentarios_Correo").val();if($("#Comentarios_Web").val()!==""){localStorage["Comentarios_Web"]=$("#Comentarios_Web").val();}
nAjax=$.post($Base.Raiz+"cmd/EnviarComentario",{"URL":window.location.href,"Nombre":$("#Comentarios_Nombre").val(),"Email":$("#Comentarios_Correo").val(),"Web":$("#Comentarios_Web").val(),"Comentario":$("#Comentarios_Comentario").html(),"Pagina":$("#MarcoNavegacion > article.Blog").attr("pagina"),"Autor":$(".Cabecera_Datos > .FechaEntrada > .Autor").html()});console.log("Comentarios.BotonEnviarComentario");nAjax.done(function(data){Datos=JSON.parse(data);if(Datos["HTML"].substr(0,5)==="Error"){$Base.MostrarMensaje(Datos["HTML"]);}
else{$("#Comentarios_Datos").html(Datos["HTML"]+$("#Comentarios_Datos").html());$Comentarios.Iniciar();$("body, html").stop().animate({scrollTop:$("#Comentarios_Datos").offset().top-200},200);$Base.MostrarMensaje("Comentario enviado correctamente.");}
$Base.Cargando("FALSE");$Comentarios.Enviando=false;$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}});nAjax.fail(function(jqXHR,textStatus,tError){console.log("Comentarios.BotonEnviarComentario Error ajax",jqXHR,textStatus,tError);$Base.MostrarMensaje("Error enviando el comentario.");$Base.Cargando("FALSE");$Comentarios.Enviando=false;});return true;};this.Obtener20=function(){if($("div[fincomentarios=true]").offset())return;if(this.Obteniendo===true)return;$Base.ResetearTimerTiempoSesion();$Base.Cargando("TRUE");Pagina=$("#MarcoNavegacion > article.Blog").attr("pagina")
Desde=$("#Comentarios_Datos div[comentario]:last-child").attr("comentario");console.log("Comentarios.Obtener20",Pagina,Desde);this.Obteniendo=true;nAjax=$.post($Base.Raiz+"cmd/ObtenerComentarios",{"Pagina":Pagina,"Desde":Desde-1,"Hasta":Desde-21});nAjax.done(function(data){Datos=JSON.parse(data);$("div[puntoscroll=true]").removeAttr("puntoscroll");$("#Comentarios_Datos").html($("#Comentarios_Datos").html()+Datos["HTML"]);$Base.Cargando("FALSE");$Comentarios.Iniciar();$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}});nAjax.fail(function(jqXHR,textStatus,tError){console.log("Comentarios.Obtener20 Error ajax",jqXHR,textStatus,tError);$Base.MostrarMensaje("Error cargando los 20 siguientes comentarios");$Base.Cargando("FALSE");$Comentarios.Obteniendo=false;});};this.ObtenerHastaNum=function(Num){if($("div[fincomentarios=true]").offset())return;if(this.Obteniendo===true)return;$Base.ResetearTimerTiempoSesion();$Base.Cargando("TRUE");Pagina=$("#MarcoNavegacion > article.Blog").attr("pagina");Desde=$("#Comentarios_Datos div[comentario]:last-child").attr("comentario");console.log("Comentarios.ObtenerHastaNum",Pagina,Desde);this.Obteniendo=true;nAjax=$.post($Base.Raiz+"cmd/ObtenerComentarios",{"Pagina":Pagina,"Desde":Desde-1,"Hasta":Num});nAjax.done(function(data){Datos=JSON.parse(data);$("div[puntoscroll=true]").removeAttr("puntoscroll");$("#Comentarios_Datos").html($("#Comentarios_Datos").html()+Datos["HTML"]);$Comentarios.Obteniendo=false;$Comentarios.Iniciar();$Base.Cargando("FALSE");$Comentarios.MostrarComentario($Comentarios.NumComentario);$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}});nAjax.fail(function(jqXHR,textStatus,tError){console.log("Comentarios.ObtenerHastaNum Error ajax",jqXHR,textStatus,tError);$Base.MostrarMensaje("Error cargando el comentario [#"+$Comentarios.NumComentario+"].");$Base.Cargando("FALSE");$Comentarios.Obteniendo=false;});};this.MostrarComentario=function(Num){setTimeout(function(){$Comentarios.SeleccionarComentario($("#Comentarios_Datos div[comentario="+Num+"]"));},10);if($("#Comentarios_Datos div[comentario="+Num+"]").offset()){console.log("Comentarios.MostrarComentario",Num);Pos=$("#Comentarios_Datos div[comentario="+Num+"]").offset().top;Tam=$("#Comentarios_Datos div[comentario="+Num+"]").height()+40;PosScroll=$("body").scrollTop()||$("html").scrollTop();if(!(Pos>PosScroll&&Pos<PosScroll+($(window).height()-Tam))){$("body, html").stop().animate({scrollTop:Pos-($(window).height()-Tam)},200);}
if(this.MostrarComentarioTimer!==0&&Num!==this.NumComentario){$("#Comentarios_Datos div[resaltado=true]").removeAttr("resaltado");console.log("Comentarios.MostrarComentario (CancelarTimerAni)",this.MostrarComentarioTimer);clearTimeout(this.MostrarComentarioTimer);this.MostrarComentarioTimer=0;}
if(Num!==this.NumComentario){$("#Comentarios_Datos div[comentario="+Num+"]").attr("resaltado","true");this.MostrarComentarioTimer=setTimeout(function(){$("#Comentarios_Datos div[resaltado=true]").removeAttr("resaltado");console.log("Comentarios.MostrarComentario (FinTimerAni)",$Comentarios.MostrarComentarioTimer);$Comentarios.MostrarComentarioTimer=0;$Comentarios.NumComentario=0;},5000);}}
else{if($("div[fincomentarios=true]").offset()){$Base.MostrarMensaje("El mensaje #"+Num+" no existe o ha sido eliminado.");}
else{this.ObtenerHastaNum(Num-20);}}
this.NumComentario=Num;};this.PuntoScroll=function(){Comentario=$("div[puntoscroll=true]");if(Comentario.offset()){if(($(window).scrollTop()+$(window).height())>Comentario.offset().top){$Comentarios.Obtener20();}}};this.ComandoEdicion=function(Comando,Param){if(typeof Param==='undefined')Param=null;console.log("Comentarios.ComandoEdicion",Comando);$("#Comentarios_Comentario").focus();document.execCommand(Comando,false,Param);this.AsignarEstadosBotones();};this.AsignarEstadosBotones=function(){console.log("Comentarios.AsignarEstadosBotones");$("#Comentarios_BarraControles > .BotonEdicion:nth-child(1)").attr({"marcado":(document.queryCommandState("bold"))?true:false});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(2)").attr({"marcado":(document.queryCommandState("underline"))?true:false});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(3)").attr({"marcado":(document.queryCommandState("italic"))?true:false});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(4)").attr({"marcado":(document.queryCommandState("strikethrough"))?true:false});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(7)").attr({"marcado":(document.queryCommandState("insertunorderedlist"))?true:false});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(8)").attr({"marcado":(document.queryCommandState("insertorderedlist"))?true:false});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(10)").attr({"marcado":(document.queryCommandState("justifyLeft"))?true:false});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(11)").attr({"marcado":(document.queryCommandState("justifyCenter"))?true:false});$("#Comentarios_BarraControles > .BotonEdicion:nth-child(12)").attr({"marcado":(document.queryCommandState("justifyRight"))?true:false});};this.InsertarHTML=function(HTML){document.getElementById("Comentarios_Comentario").focus();this.CursorAlFinal();var Seleccion=window.getSelection();if(Seleccion.getRangeAt&&Seleccion.rangeCount){var Rango=Seleccion.getRangeAt(0);var Elemento=document.createElement("div");Elemento.innerHTML=HTML;var Fragmento=document.createDocumentFragment();var Nodo,UltimoNodo;while((Nodo=Elemento.firstChild)){UltimoNodo=Fragmento.appendChild(Nodo);}
Rango.insertNode(Fragmento);this.CursorAlFinal();}};this.CursorAlFinal=function(){Elemento=document.getElementById("Comentarios_Comentario");var Rango=document.createRange();Rango.selectNodeContents(Elemento);Rango.collapse(false);var Seleccion=window.getSelection();Seleccion.removeAllRanges();Seleccion.addRange(Rango);};};$(window).scroll(function(){$Comentarios.PuntoScroll();});
$PintarCodigo=new function(){this.CodigoTemporizador=0;this.EnlazarEtiquetas=function(){console.log("PintarCodigo.Iniciar");$("linea").off("click").on("click",function(e){$PintarCodigo.MostrarLineaCodigo($(this).attr("cid"),$(this).attr("l"));});$("linea, a[cid][l]").off("mouseover").on("mouseover",function(e){Lineas=$(this).attr("l").split(",");console.log("$PintarCodigo.EnlazarEtiquetas > linea:mousehover",Lineas);for(var i=0;i<Lineas.length;i++){$("#"+$(this).attr("cid")+" > .Codigo_PRECodigo > div[l="+Lineas[i]+"]").attr({"hover":"true"});}});$("linea, a[cid][l]").off("mouseout").on("mouseout",function(e){Lineas=$(this).attr("l").split(",");console.log("$PintarCodigo.EnlazarEtiquetas > linea:mouseout",Lineas);for(var i=0;i<Lineas.length;i++){$("#"+$(this).attr("cid")+" > .Codigo_PRECodigo > div[l="+Lineas[i]+"]").removeAttr("hover");}});};this.MostrarLineaCodigo=function(ID,Lineas){console.log("PintarCodigo.MostrarLineaCodigo",ID,Lineas);Linea=Lineas.split(',');if(this.CodigoTemporizador!=0){clearTimeout(this.CodigoTemporizador);$(".Codigo_PRECodigo > div[l]").removeAttr("click");this.CodigoTemporizador=0;}
for(var i=0;i<Lineas.length;i++){$("#"+ID+" > .Codigo_PRECodigo > div[l="+Linea[i]+"]").attr({"click":"true"});}
this.CodigoTemporizador=setTimeout(function(){$(".Codigo_PRECodigo > div[l]").removeAttr("click");$PintarCodigo.CodigoTemporizador=0;},900);var CodigoDivC=$("#"+ID+" > .Codigo_PRECodigo > div[l="+Linea[0]+"]");if(CodigoDivC.offset()){Pos=CodigoDivC.offset().top-10;Tam=CodigoDivC.height()+20;PosScroll=$("body").scrollTop()||$("html").scrollTop();WindowHeight=$(window).height();console.log("PintarCodigo.MostrarLineaCodigo (reposicionando)",Pos,PosScroll,Tam,WindowHeight);if(!(Pos>PosScroll&&Pos<PosScroll+(WindowHeight-Tam))){if(Pos>PosScroll){$("body, html").stop().animate({scrollTop:Pos-(WindowHeight-Tam)},200);}
else{$("body, html").stop().animate({scrollTop:Pos},200);}}}};};
$Lab=new function(){this.Lab_Temporizador=0;this.Editor=new Object;this.Archivo="";this.Original="";this.ForzarVista="-1";this.Modo="text/html";this.Guardando=false;this.Iniciar=function(){console.log("Lab.Iniciar",this.Archivo);this.EnlazarEventosExplorador();this.Editor=CodeMirror.fromTextArea(document.getElementById('Lab_Codigo'),{mode:this.Modo,indentUnit:4,fixedGutter:false,lineNumbers:true,autoCloseTags:true,autoCloseBrackets:true,matchTags:{bothTags:true},extraKeys:{"Ctrl-S":function(instance){if(typeof $Admin!=="undefined"){$Admin.Lab_Guardar();}
else{$Base.MostrarMensaje("No tienes permiso para guardar archivos.");}}}});this.Editor.on("change",function(cm,change){if($Lab.Lab_Temporizador!==0){clearTimeout($Lab.Lab_Temporizador);}
$Lab.Lab_Temporizador=setTimeout(function(){$Lab.ActualizarResultado();if($Lab.Original!==$Lab.Editor.getValue()){$("body").attr({"modificado":"true"});}
else{$("body").attr({"modificado":"false"});}
$Lab.Lab_Temporizador=0;},1500);});this.Original=$("#Lab_Codigo").val();switch(this.ForzarVista){case"0":$(".Lab_BotonVerFilas").trigger("click");break;case"1":$(".Lab_BotonVerColumnas").trigger("click");break;case"2":$(".Lab_BotonVerCodigo").trigger("click");break;case"3":$(".Lab_BotonVerPreview").trigger("click");break;}
this.ResaltarArchivoActual(this.Archivo);this.ActualizarResultado();setTimeout(function(){$Lab.Editor.setSize(parseInt($(".Codemirror").attr("width")),parseInt($(".Codemirror").attr("height")));},5000);};this.EnlazarEventosExplorador=function(){console.log("Lab.EnlazarEventosExplorador");$(".Lab_Explorador .Lab_Archivo").off("click").on("click",function(){$Lab.ClickArchivo($(this));});$(".Lab_Explorador .Lab_Directorio").off("click").on("click",function(){$Lab.ClickDirectorio($(this));});$(".Lab_Explorador .Lab_Archivo > a").off("click").on("click",function(e){$Lab.ClickArchivo($(this).parent());e.preventDefault();e.stopImmediatePropagation();return false;});};this.ClickDirectorio=function(Objeto,SoloAbrir){console.log("Lab.ClickDirectorio",Objeto);Animacion=Objeto.next();Directorio=Animacion.find(".Lab_Lista");var Altura=Animacion.css("height");var AltoPadre=0;if(typeof(SoloAbrir)==="undefined"){if(parseInt(Altura)===0){Animacion.css({"height":Directorio.height()});AltoPadre=Directorio.height();}
else{Animacion.css({"height":0});AltoPadre=-Directorio.height();}}
else{if(parseInt(Altura)===0){Animacion.css({"height":Directorio.height()});AltoPadre=Directorio.height();}
else{return;}}
Padre=Objeto.parent().parent().parent();while(Padre!==null){if(Padre.attr("class")!=="Lab_Directorio_Animacion")break;Padre.css({"height":Padre.height()+AltoPadre});Padre=Padre.parent().parent().parent();}};this.ClickArchivo=function(Objeto){console.log("Lab_ClickArchivo",Objeto);var Rec=Objeto;var Ret=Rec.find("a").html();while(Rec!==null){Rec=Rec.parent().parent().parent().prev();if(Rec.attr("class")!=="Lab_Directorio")break;Ret=Rec.find("span").html()+"/"+Ret;}
Ret="Ejemplos/"+Ret;this.CargarArchivo(Ret);};this.ResaltarArchivoActual=function(Archivo){var UActual=$(".Lab_Explorador .Lab_Archivo[actual]");if(UActual.length>0){UActual.removeAttr("actual");}
ItemActual=$(".Lab_Explorador .Lab_Archivo[path='/Lab/"+Archivo+"']");ItemActual.attr("actual","true");Padre=ItemActual.parent().parent().parent().prev();while(Padre.length!==0){if(Padre[0].className==="Lab_Directorio"){$Lab.ClickDirectorio(Padre,true);}
Padre=Padre.parent().parent().parent().prev();}};this.CargarArchivo=function(Archivo,ID){$Base.ResetearTimerTiempoSesion();$Base.Cargando("TRUE");$Base.CargarArchivo_nopush=false;console.log("Lab.CargarArchivo",Archivo);if(Archivo===null){Archivo=$Base.Archivo;$Base.CargarArchivo_nopush=true;}
if(ID===undefined){ID=-1;}
this.PeticionAjax=$.post($Base.Raiz+"cmd/LabAbrirEjemplo.cmd",{"Archivo":Archivo,"ID":ID},function(data){Datos=JSON.parse(data);if(Datos["Ret"]===404){$Base.MostrarErrorAjax(404,false);}
else if(Datos["Ret"]===403){$Base.MostrarErrorAjax(403,false);}
else{if(Datos["ID"]===-1){$Lab.ResaltarArchivoActual(Datos["Archivo"]);$Lab.Editor.setOption("mode",Datos["Modo"]);$Lab.Editor.setValue(Datos["Datos"]);$Lab.Original=$Lab.Editor.getValue();switch(Datos["Vista"]){case"0":$(".Lab_BotonVerFilas").trigger("click");break;case"1":$(".Lab_BotonVerColumnas").trigger("click");break;case"2":$(".Lab_BotonVerCodigo").trigger("click");break;case"3":$(".Lab_BotonVerPreview").trigger("click");break;}
URL="/"+$Base.RaizRelativa+"Lab/"+Datos["Archivo"];$("#MarcoNavegacionLab").attr({"pagina":Datos["Archivo"]});if($Base.CargarArchivo_nopush===false){$Base.Entrada=$Base.IdentificarEntrada(URL,URL);$Base.Entrada["Titulo"]="Lab : "+Datos["Archivo"];window.history.pushState($Base.Entrada,document.title,URL);$(window).scrollTop(0);document.title=$Base.Entrada["Titulo"];}
$("body").attr({"modificado":"false"});$Base.ComprobarScrollVotacion();$Lab.ActualizarResultado();$("#ErroresPHP_Info").html(Datos["ErroresPHP"]);if(Datos["ErroresPHP"]!==""){$Base.MostrarErroresPHP();}}
else{$Lab.MiniLab_Editores[Datos["ID"]].setValue(Datos["Datos"]);$Lab.MiniLab_ActualizarResultado(Datos["ID"]);}
$Base.Cargando("FALSE");}}).fail(function(jqXHR,textStatus,tError){console.log("Lab.CargarArchivo Error ajax",jqXHR,textStatus,tError);$Base.MostrarErrorAjax((jqXHR.status===404)?1404:jqXHR.status,false,tError);});};this.AjustarVista=function(NuevaVista,Guardar){if(document.getElementById("Lab_Barra1")===null){return;}
if(NuevaVista==="-1"){NuevaVista=(typeof(localStorage["Lab_Vista"])==="undefined")?"0":localStorage["Lab_Vista"];}
else{if(typeof(Guardar)==="undefined"){localStorage["Lab_Vista"]=NuevaVista;}
else{if(Guardar===true){localStorage["Lab_Vista"]=NuevaVista;}}}
if(typeof $("#BarraPrincipal").css("zoom")==="undefined"){Zoom=1;}
else{Zoom=$("#BarraPrincipal").css("zoom");}
if(Zoom==="normal")Zoom=1;console.log("$Lab.AjustarVista",NuevaVista,Zoom);AnchoMenu=$("#BarraPrincipal").outerWidth()*Zoom;Ancho=window.innerWidth-(AnchoMenu*2);Alto=window.innerHeight;AnchoBarra1=parseInt($("#Lab_Barra1").outerWidth());switch(NuevaVista){case"0":$("#BarraNavegacion_Lab_IconoVer").attr({"ver":"filas"});break;case"1":$("#BarraNavegacion_Lab_IconoVer").attr({"ver":"columnas"});break;case"2":$("#BarraNavegacion_Lab_IconoVer").attr({"ver":"codigo"});break;case"3":$("#BarraNavegacion_Lab_IconoVer").attr({"ver":"preview"});break;}
switch(NuevaVista){case"0":$(".CodeMirror").css({"display":"block"});PosBarra=Math.round((Alto-6)/2);$("#Lab_Barra1").css({top:PosBarra,left:AnchoMenu,height:4,width:Ancho,display:"block",cursor:"ns-resize"});$("#Lab_Barra1").draggable({axis:"y",cursor:"ns-resize",containment:"#MarcoNavegacion",start:function(event,ui){$("#Lab_ParcheIframe").css({"display":"block"});$Lab.DragFilas(false);},drag:function(event,ui){$Lab.DragFilas(false);},stop:function(event,ui){$("#Lab_ParcheIframe").css({"display":"none"});$Lab.DragFilas(true);}});$("#Lab_Preview").css({left:AnchoMenu,width:Ancho+1,display:"block"});this.DragFilas(false);$("#Lab_Preview").focus();break;case"1":$(".CodeMirror").css({"display":"block"});PosBarra=Math.round((Ancho-6)/2);$("#Lab_Barra1").css({top:0,left:PosBarra+AnchoMenu,height:Alto,width:4,display:"block",cursor:"ew-resize"});$("#Lab_Barra1").draggable({axis:"x",cursor:"ew-resize",containment:"#MarcoNavegacionLab",start:function(event,ui){$("#Lab_ParcheIframe").css({"display":"block"});$Lab.DragColumnas(false);},drag:function(event,ui){$Lab.DragColumnas(false);},stop:function(event,ui){$("#Lab_ParcheIframe").css({"display":"none"});$Lab.DragColumnas(true);}});$("#Lab_Preview").css({height:Alto+1,left:PosBarra+AnchoMenu+4,top:0,display:"block"});this.DragColumnas(false);$("#Lab_Preview").focus();break;case"2":$("#Lab_Barra1").css({display:"none"});$("#Lab_Preview").css({display:"none"});this.Editor.setSize(Ancho,Alto);$(".CodeMirror").css({"display":"block"});break;case"3":$("#Lab_Barra1").css({display:"none"});$("#Lab_Preview").css({display:"block",top:0,left:AnchoMenu,height:Alto,width:Ancho});$(".CodeMirror").css({"display":"none"});$("#Lab_Preview").focus();break;}};this.DragFilas=function(GuardarDatos){if(document.getElementById("Lab_Barra1")===null){return;}
if(typeof $("#BarraPrincipal").css("zoom")==="undefined"){Zoom=1;}
else{Zoom=$("#BarraPrincipal").css("zoom");}
AltoBarra=$("#Lab_Barra1").outerHeight();AnchoMenu=$("#BarraPrincipal").outerWidth()*Zoom;Ancho=window.innerWidth-(AnchoMenu*2);Alto=$(window).outerHeight();PosBarra=$("#Lab_Barra1").offset().top;this.Editor.setSize(Ancho,PosBarra);$("#Lab_Preview").css({"top":PosBarra+AltoBarra,"height":(Alto-(PosBarra+AltoBarra))});};this.DragColumnas=function(GuardarDatos){if(document.getElementById("Lab_Barra1")===null){return;}
if(typeof $("#BarraPrincipal").css("zoom")==="undefined"){Zoom=1;}
else{Zoom=$("#BarraPrincipal").css("zoom");}
AnchoMenu=$("#BarraPrincipal").outerWidth()*Zoom;AnchoBarra=$("#Lab_Barra1").outerWidth();Alto=$(window).outerHeight();Ancho=window.innerWidth-(AnchoMenu);PosBarra=$("#Lab_Barra1").offset().left;this.Editor.setSize(((PosBarra-AnchoMenu)>0)?PosBarra-AnchoMenu:0,Alto);$("#Lab_Preview").css({"left":PosBarra+AnchoBarra,"width":(Ancho-(PosBarra+AnchoBarra))});};this.ActualizarResultado=function(){if(this.Lab_Temporizador!==0)clearTimeout(this.Lab_Temporizador);var Estilos=$("#Lab_Preview").attr("style");$("#Lab_Preview").remove();$("<iframe id='Lab_Preview' style='"+Estilos+"'></iframe>").insertBefore($("#Lab_Barra1"));var previewFrame=document.getElementById('Lab_Preview');var preview=previewFrame.contentDocument||previewFrame.contentWindow.document;preview.open();var Codigo=this.Editor.getValue();preview.write(Codigo);preview.close();this.Lab_Temporizador=0;};this.Modificado=function(){return false;};this.MiniLab_Editores=[];this.MiniLab_Iniciar=function(){console.log("Lab.MiniLab_Iniciar");this.MiniLab_Editores=[];MiniLabs=document.getElementsByClassName("MiniLab_Codigo");for(var i=0;i<MiniLabs.length;i++){Archivo=MiniLabs[i].parentNode.getAttribute("archivo");this.MiniLab_Editores[i]=CodeMirror.fromTextArea(MiniLabs[i],{mode:'text/html',indentUnit:4,fixedGutter:false,lineNumbers:true,autoCloseTags:true,autoCloseBrackets:true,matchTags:{bothTags:true}});this.MiniLab_Editores[i].PosObjeto=i;this.MiniLab_Editores[i].on("change",function(cm,change){$Lab.MiniLab_ActualizarResultado(cm.PosObjeto);});this.CargarArchivo(Archivo,i);}
$(".MiniLab_VerCodigo").off("click").on("click",function(event){this.parentNode.parentNode.setAttribute("ver","codigo");ID=this.parentNode.parentNode.getAttribute("id").replace("MiniLab_","");$Lab.MiniLab_Editores[ID].refresh();});$(".MiniLab_VerPreview").off("click").on("click",function(event){this.parentNode.parentNode.setAttribute("ver","preview");});$(".MiniLab_VerMixto").off("click").on("click",function(event){this.parentNode.parentNode.setAttribute("ver","mixto");ID=this.parentNode.parentNode.getAttribute("id").replace("MiniLab_","");$Lab.MiniLab_Editores[ID].refresh();});$(".MiniLab_ContenedorBotones > label").off("click").on("click",function(event){Raiz=$(this).parent().parent();Raiz.find(".MiniLab[oculto='false']").attr({"oculto":"true"});Actual=Raiz.find(".MiniLab:nth-child("+$(this).html()+")");Actual.attr({"oculto":"false"});$Lab.MiniLab_Editores[Actual.attr("id").replace("MiniLab_","")].refresh();});};this.MiniLab_ActualizarResultado=function(ID){console.log("Lab.MiniLab_ActualizarResultado",ID);var previewFrame=document.getElementById('MiniLab_'+ID).getElementsByClassName("MiniLab_Preview")[0];var preview=previewFrame.contentDocument||previewFrame.contentWindow.document;preview.open();var Codigo=this.MiniLab_Editores[ID].getValue();preview.write(Codigo);preview.close();};};$(window).resize(function(){$Lab.AjustarVista("-1",false);});
var $Banner=null;var Banner_Depurar=false;ObjetoBanner=function(Tipo){$("#CH_PausarBanner").attr({"marcado":!Banner_Depurar});$("#Cabecera_Canvas").remove();$("#Cabecera").append("<canvas id='Cabecera_Canvas'></canvas>");this.Canvas=document.getElementById("Cabecera_Canvas");this.Cargando(true);if(typeof(Tipo)==="undefined"){this.Tipo="2d";}
else{this.Tipo=Tipo;}
console.log("constructor ObjetoBanner",this.Tipo);try{if(this.Tipo==="2d"){this.Context=this.Canvas.getContext("2d");}else if(this.Tipo==="THREE"){if(this.PixelRatio()>1){this.Context=new THREE.WebGLRenderer({canvas:this.Canvas});}
else{this.Context=new THREE.WebGLRenderer({canvas:this.Canvas,antialias:true});}
this.Context.setClearColor(0x312E35,1);}}
catch(error){document.getElementById("Cabecera_Cargando").innerHTML="Error iniciando WebGL : "+error+"<br />"+"Si estas en chrome abre el enlace 'chrome://gpu', y vuelve atrás para re-cargar este ejemplo.";return false;}
this.Ancho=0;this.Alto=0;this.RAFID=0;this.FPS_UltimoTick=Date.now()+1000;this.FPS_Contador=0;this.PIx2=Math.PI*2;this.FocoWeb=true;$("#CabeceraAutorAni_HTML").html("<div>"+this.Nombre+"</div>"+"<div><span style='color:#AAA;'>Concepto original : </span><b>"+this.IdeaOriginal+"</b></div>"+"<a href='"+this.URL+"' target='_blank'>"+this.NombreURL+"</a>");$("#Cabecera_AutorAni > .BotonVentana:nth-child(1)").off("click").on("click",function(){$Base.Banner(-1);});$("#Cabecera_AutorAni > .BotonVentana:nth-child(3)").off("click").on("click",function(){$Base.Banner(-2);});this.EventoRedimensionar();this.RAFID=window.requestAnimationFrame(this.Actualizar.bind(this));document.getElementById("Cabecera").addEventListener('mousemove',this.EventoMouseMove.bind(this));document.getElementById("Cabecera").addEventListener('mouseenter',this.EventoMouseEnter.bind(this));document.getElementById("Cabecera").addEventListener('mouseleave',this.EventoMouseLeave.bind(this));$("#Cabecera").on("mousemove",function(event){if($Banner!==null){$Banner.EventoMouseMove(event);}});$("#Cabecera").on("mouseenter",function(event){if($Banner!==null){$Banner.EventoMouseEnter(event);}});$("#Cabecera").on("mouseleave",function(event){if($Banner!==null){$Banner.EventoMouseLeave(event);}});return true;};ObjetoBanner.prototype.PixelRatio=function(){var ratio=1;if(window.screen.systemXDPI!==undefined&&window.screen.logicalXDPI!==undefined&&window.screen.systemXDPI>window.screen.logicalXDPI){ratio=window.screen.systemXDPI/window.screen.logicalXDPI;}
else if(window.devicePixelRatio!==undefined){ratio=window.devicePixelRatio;}
return ratio;};ObjetoBanner.prototype.Cargando=function(carga){$("#Cabecera").attr({"cargando":carga});};ObjetoBanner.prototype.Actualizar=function(){this.FPS();this.RAFID=window.requestAnimationFrame(this.Actualizar.bind(this));this.Pintar.apply(this);};ObjetoBanner.prototype.EventoMouseMove=function(event){if(typeof(this.MouseMove)!=="undefined"){this.MouseMove.apply(this,event);}};ObjetoBanner.prototype.EventoMouseEnter=function(event){if(typeof(this.MouseEnter)!=="undefined"){this.MouseEnter.apply(this,event);}};ObjetoBanner.prototype.EventoMouseLeave=function(event){if(typeof(this.MouseLeave)!=="undefined"){this.MouseLeave.apply(this,event);}};ObjetoBanner.prototype.EventoRedimensionar=function(){this.Ancho=document.getElementById("MarcoNavegacion").offsetWidth-60;this.Alto=this.Canvas.offsetHeight;this.Canvas.setAttribute("width",this.Ancho);this.Canvas.setAttribute("height",this.Alto);if(this.Tipo==="THREE"){this.Context.setSize(this.Ancho,this.Alto);if(this.Camara!==null&&typeof(this.Camara)!=='undefined'){this.Camara.aspect=this.Ancho/this.Alto;this.Camara.updateProjectionMatrix();}}
if(typeof(this.Redimensionar)!=="undefined"){this.Redimensionar.apply(this);}};ObjetoBanner.prototype.Pausa=function(){if(this.RAFID!==0&&Banner_Depurar===false){$("#Cabecera").attr({"animar":"false"});console.log("Banner.Pausa");window.cancelAnimationFrame(this.RAFID);this.RAFID=0;}};ObjetoBanner.prototype.Reanudar=function(){if(this.RAFID===0&&this.FocoWeb===true){$("#Cabecera").attr({"animar":"true"});this.RAFID=window.requestAnimationFrame(this.Actualizar.bind(this));console.log("Banner.Reanudar RAFID = "+this.RAFID);}};ObjetoBanner.prototype.EventoScroll=function(){var Header=$("#Cabecera");if(Header.length>0){var PS=$(window).scrollTop();var Altura=Header.get(0).offsetHeight;if(PS>Altura){if($Banner!==null){$Banner.Pausa();}}
else if(PS<Altura){if($Banner!==null){$Banner.Reanudar();}}
if(typeof(this.Scroll)!=="undefined"){this.Scroll.apply(this);}}};ObjetoBanner.prototype.FPS=function(){var Tick=Date.now();if(Tick>this.FPS_UltimoTick){this.FPS_UltimoTick=Tick+1000;$("#Cabecera_Stats").html(this.FPS_Contador+" FPS");this.FPS_Contador=0;}
else{this.FPS_Contador++;}};var BufferCanvas=function(Ancho,Alto){this.Canvas=document.createElement("canvas");this.Canvas.setAttribute("width",Ancho);this.Canvas.setAttribute("height",Alto);this.Context=this.Canvas.getContext("2d");this.Ancho=Ancho;this.Alto=Alto;};var ObjetoAnimacion_Paso=function(Datos,Tiempo,Retraso,FuncionTiempo){this.Datos=Datos;this.Tiempo=(typeof Tiempo!=='undefined')?Tiempo:1;this.Retraso=(typeof Retraso!=='undefined')?Retraso:0;this.Funcion=(typeof FuncionTiempo!=='undefined')?Funcion:function(){};};var ObjetoAnimacion=function(ArrayPasos,FuncionTerminado){this._UltimoTick=0;this._Pasos=ArrayPasos;this._PosPasos=1;this._PasoOrig=this._Pasos[this._PosPasos-1];this._PasoDest=this._Pasos[this._PosPasos];this._Avance=0;this._FuncionTerminado=(typeof FuncionTerminado!=='undefined')?FuncionTerminado:function(){};this.Terminado=false;for(var Indice in this._PasoOrig.Datos){this[Indice]=this._PasoOrig.Datos[Indice];}
this.Actualizar=function(){if(this.Terminado===true){return;}
var t=Date.now();if(this._UltimoTick!==0){var TiempoFrame=t-this._UltimoTick;if(this._PasoDest.Retraso>0){this._PasoDest.Retraso=this._PasoDest.Retraso-TiempoFrame;}
else{this._Avance+=(TiempoFrame/this._PasoDest.Tiempo);for(var Indice in this._PasoDest.Datos){this[Indice]=this._PasoOrig.Datos[Indice]-(this._PasoOrig.Datos[Indice]-this._PasoDest.Datos[Indice])*this._Avance;}
if(this._Avance>=1){this._PosPasos++;if(this._PosPasos<this._Pasos.length){this._PasoOrig=this._Pasos[this._PosPasos-1];this._PasoDest=this._Pasos[this._PosPasos];this._Avance=0;}
else{this.Terminado=true;this._FuncionTerminado();}}}}
this._UltimoTick=t;};};$(window).on("resize",function(){if($Banner!==null){$Banner.EventoRedimensionar();}});$(window).on("scroll",function(){if($Banner!==null){$Banner.EventoScroll();}});$(window).on("blur",function(){console.log("Foco de la ventana perdido");if($Banner!==null){$Banner.FocoWeb=false;$Banner.Pausa();}});$(window).on("focus",function(){console.log("Foco de la ventana recibido");if($Banner!==null){$Banner.FocoWeb=true;if($(window).scrollTop()<190){$Banner.Reanudar();}}});
var Banner_Espacio2D=function(){if(ObjetoBanner.call(this,"2d")===false){return false;}
this.Estrellas=[];this.TotalEstrellas=((this.Ancho*this.Alto)/250);for(var i=0;i<this.TotalEstrellas;i++){var Vel=Rand(5)+0.5;var Col=199+Math.floor(Vel*10);this.Estrellas[i]=new this.Estrella(RandInt(this.Ancho),RandInt(this.Alto),Vel,"rgb("+Col+","+Col+","+Col+")");}
this.Cargando(false);};Banner_Espacio2D.prototype=Object.assign(Object.create(ObjetoBanner.prototype),{constructor:Banner_Espacio2D,Nombre:"Espacio 2D",IdeaOriginal:"devildrey33",URL:"http://devildrey33.es/Blog/Canvas2D_1",NombreURL:"Tutorial HTML5 Canvas2D parte 1",Redimensionar:function(){},Scroll:function(){},Pintar:function(){this.Context.fillStyle='rgba(49, 46, 53, 0.4)';this.Context.fillRect(0,0,this.Ancho,this.Alto);for(i=0;i<this.TotalEstrellas;i++){this.Estrellas[i].X-=this.Estrellas[i].Velocidad;if(this.Estrellas[i].X<0){var Vel=Rand(5)+0.5;var Col=199+Math.floor(Vel*10);this.Estrellas[i]=new this.Estrella(this.Ancho,RandInt(this.Alto),Vel,"rgb("+Col+","+Col+","+Col+")");}
this.Context.fillStyle=this.Estrellas[i].Color;this.Context.fillRect(this.Estrellas[i].X,this.Estrellas[i].Y,1,1);}},Estrella:function(X,Y,Velocidad,Color){this.X=X;this.Y=Y;this.Velocidad=Velocidad;this.Color=Color;}});
var Banner_Colisiones=function(){if(ObjetoBanner.call(this,"2d")===false){return false;}
this.CirculosSuperior=[];this.CirculosMedio=[];this.CirculosInferior=[];this.Colision=false;this.Velocidad=1.26;this.CirculosSuperior=[];this.CirculosMedio=[];this.CirculosInferior=[];for(var Y=1;Y<(this.Alto/70);Y++){for(var X=1;X<(this.Ancho/110);X++){var x=X*110+Rand(-20,20);var y=Y*70+Rand(-16,16);var Rnd=RandInt(0,3);if(Rnd===0||Rnd===2){var Color="rgb("+RandInt(95,75)+","+RandInt(121,101)+","+RandInt(135,115)+")";this.CirculosSuperior.push(new this.Circulo(x,y,Rand(16,10),Color,this.Velocidad));}
if(Rnd===0||Rnd===1){var Color="rgb("+RandInt(147,127)+","+RandInt(149,129)+","+RandInt(81,61)+")";this.CirculosMedio.push(new this.Circulo(x,y,Rand(8,7),Color,this.Velocidad));}
var Color="rgb("+RandInt(112,92)+","+RandInt(89,69)+","+RandInt(97,77)+")";this.CirculosInferior.push(new this.Circulo(x,y,Rand(6,4),Color,this.Velocidad));}}
this.Cargando(false);};Banner_Colisiones.prototype=Object.assign(Object.create(ObjetoBanner.prototype),{constructor:Banner_Colisiones,Nombre:"Colisiones",IdeaOriginal:"mxmx",URL:"http://codepen.io/mnmxmx/pen/mEVxeg",NombreURL:"Particles",Redimensionar:function(){},Scroll:function(){},Pintar:function(){this.Context.fillStyle="rgba(49,46,53, 1)";this.Context.fillRect(0,0,this.Ancho,this.Alto);this.PintarArrayCirculos(this.CirculosInferior);this.PintarArrayCirculos(this.CirculosMedio);this.PintarArrayCirculos(this.CirculosSuperior);},PintarArrayCirculos:function(ArrayCirculos){this.ComprobarDistancia(ArrayCirculos);var Tam=ArrayCirculos.length;for(var i=0;i<Tam;i++){var C=ArrayCirculos[i];C.Actualizar();this.Context.globalAlpha=1;this.Context.fillStyle=C.Color;this.Context.beginPath();this.Context.arc(C.X,C.Y,C.Radio,0,this.PIx2,false);this.Context.fill();}},ComprobarDistancia:function(ArrayCirculos){var Tam=ArrayCirculos.length;for(var i=0;i<Tam-1;i++){for(var j=i+1;j<Tam;j++){var p0=ArrayCirculos[i];var p1=ArrayCirculos[j];var Distancia=(p1.X-p0.X)*(p1.X-p0.X)+(p1.Y-p0.Y)*(p1.Y-p0.Y);var Angulo=Math.atan2(p1.Y-p0.Y,p1.X-p0.X);if(Distancia<7500&&ArrayCirculos===this.CirculosSuperior||Distancia<5000&&ArrayCirculos===this.CirculosMedio||Distancia<3000&&ArrayCirculos===this.CirculosInferior){this.Context.globalAlpha=.4;this.Context.strokeStyle="rgb(235,235,235)";this.Context.beginPath();this.Context.moveTo(p0.X,p0.Y);this.Context.lineTo(p1.X,p1.Y);this.Context.stroke();}
if(Distancia<(p0.Radio+p1.Radio)*(p0.Radio+p1.Radio)){this.Colision=true;var Velocidad=3.33;p1.VelocidadX=Math.cos(Angulo)*Velocidad;p1.VelocidadY=Math.sin(Angulo)*Velocidad;p0.VelocidadX=-Math.cos(Angulo)*Velocidad;p0.VelocidadY=-Math.sin(Angulo)*Velocidad;}
else{this.Colision=false;}}}},Circulo:function(X,Y,Radio,Color,Velocidad){this.X=X;this.Y=Y;this.Radio=Radio;this.Color=Color;this.Velocidad=Velocidad;this.Angulo=Math.random()*(Math.PI*2);this.VelocidadX=Velocidad*Math.cos(this.Angulo);this.VelocidadY=Velocidad*Math.sin(this.Angulo);this.Actualizar=function(){if($Banner!==null){if(this.X-this.Radio<0||this.X+this.Radio>$Banner.Ancho){this.VelocidadX*=-1;}
else if(this.Y-this.Radio<0||this.Y+this.Radio>$Banner.Alto){this.VelocidadY*=-1;}
if(!$Banner.Colision){var VA=Math.sqrt(this.VelocidadX*this.VelocidadX+this.VelocidadY*this.VelocidadY);var AA=Math.atan2(this.VelocidadY,this.VelocidadX);if($Banner.Velocidad<VA){this.VelocidadX-=Math.cos(AA)*(VA-$Banner.Velocidad)*.15;this.VelocidadY-=Math.sin(AA)*(VA-$Banner.Velocidad)*.15;}}
this.X+=this.VelocidadX;this.Y+=this.VelocidadY;}};}});
var Banner_ResplandorCircular=function(){if(ObjetoBanner.call(this,"2d")===false){return false;}
this.Maximo=150;this.ColorActual=10;this.Avance=0.07;this.Circulos=[];for(var i=1;i<this.Maximo;i++){setTimeout(function(Banner){var Circulo=new Banner.Circulo(this);Banner.Circulos.push(Circulo);},i*2,this);}
this.Cargando(false);};Banner_ResplandorCircular.prototype=Object.assign(Object.create(ObjetoBanner.prototype),{constructor:Banner_ResplandorCircular,Nombre:"Resplandor circular",IdeaOriginal:"Bailh",URL:"http://codepen.io/cathbailh/pen/KpPjPg",NombreURL:"Sweet chaos in the space of tulle",Redimensionar:function(){},Scroll:function(){},Pintar:function(){this.Context.fillStyle="rgba(51, 51, 20, 0.02)";this.Context.globalCompositeOperation="source-over";this.Context.fillRect(0,0,this.Ancho,this.Alto*1);this.ColorActual+=this.Avance;if(this.ColorActual>360)this.ColorActual=0;this.Context.globalCompositeOperation="lighter";for(var C=0;C<this.Circulos.length;C++){this.Context.strokeStyle=this.Circulos[C].Color;this.Context.beginPath();this.Context.arc(this.Circulos[C].X,this.Circulos[C].Y,this.Circulos[C].Radio*0.8,0,this.PIx2);this.Context.stroke();this.Circulos[C].X+=this.Circulos[C].VelocidadX;this.Circulos[C].Y+=this.Circulos[C].VelocidadY*-2;this.Circulos[C].Avance++;if(this.Circulos[C].Avance>=this.Circulos[C].MaxAvance||this.Circulos[C].Radio<=.05){this.Circulos[C]=new this.Circulo(this);}}},Circulo:function(Padre){this.Padre=Padre;this.IniciarCirculo=function(){this.Radio=Rand(20,80);this.X=(this.Padre.Ancho/2)+Rand(5,-5);this.Y=(this.Padre.Alto/2)+Rand(2,-2);this.VelocidadX=Rand(7,-7);this.VelocidadY=Rand(3.5,-3.5);this.Color="hsla("+this.Padre.ColorActual+", 100%, 40%, .05)";this.Avance=0.004;this.MaxAvance=Rand(0,350);};this.IniciarCirculo();}});
Banner_TranstornoLineal=function(){if(ObjetoBanner.call(this,"2d")===false){return false;}
this.Tick=(Rand()*360)|0;this.MaxTriangulos=10;this.Triangulos=[];this.Context.lineWidth=.1;this.Context.fillStyle='rgb(49, 46, 53)';this.Context.fillRect(0,0,this.Ancho,this.Alto);this.Cargando(false);};Banner_TranstornoLineal.prototype=Object.assign(Object.create(ObjetoBanner.prototype),{constructor:Banner_TranstornoLineal,Nombre:"Transtorno Lineal",IdeaOriginal:"Matei Copot",URL:"https://codepen.io/towc/pen/mJroQr",NombreURL:"Lines lines lines, love 'em!",Redimensionar:function(){},Scroll:function(){},Pintar:function(){this.Tick+=.2;this.Tick%=360;this.Context.globalCompositeOperation='destination-out';this.Context.fillStyle='rgba(49, 46, 53, 0.1)';this.Context.fillRect(0,0,this.Ancho,this.Alto);this.Context.globalCompositeOperation='lighter';if(this.Triangulos.length<this.MaxTriangulos&&Rand()<0.6){this.Triangulos.push(new this.Triangulo(this));}
for(var T=0;T<this.Triangulos.length;T++){this.Triangulos[T].X+=this.Triangulos[T].VelocidadX;this.Triangulos[T].Y+=this.Triangulos[T].VelocidadY;this.Context.strokeStyle='hsl('+(this.Triangulos[T].hue+RandInt(30))+', 80%, 50%)';this.Context.save();this.Context.translate(this.Triangulos[T].X,this.Triangulos[T].Y);for(var i=0;i<this.Triangulos[T].TotalLineas;++i){var l1=this.Triangulos[T].Lineas[i];l1.p1.Avanzar();l1.p2.Avanzar();var dx1=(l1.p1.X-l1.p2.X)/this.Triangulos[T].Separaciones;var dy1=(l1.p1.Y-l1.p2.Y)/this.Triangulos[T].Separaciones;for(var j=i+1;j<this.Triangulos[T].TotalLineas;++j){var l2=this.Triangulos[T].Lineas[j];var dx2=(l2.p1.X-l2.p2.X)/this.Triangulos[T].Separaciones;var dy2=(l2.p1.Y-l2.p2.Y)/this.Triangulos[T].Separaciones;for(var k=0;k<this.Triangulos[T].Separaciones;++k){var rand1=Rand(this.Triangulos[T].jitter,-this.Triangulos[T].jitter);var rand2=Rand(this.Triangulos[T].jitter,-this.Triangulos[T].jitter);this.Context.beginPath();this.Context.moveTo(l1.p1.X+rand1+k*dx1,l1.p1.Y+rand1+k*dy1);this.Context.lineTo(l2.p1.X+rand2+k*dx2,l2.p1.Y+rand2+k*dy2);this.Context.stroke();}}}
this.Context.restore();if(this.Triangulos[T].X+this.Triangulos[T].Lado<0||this.Triangulos[T].X>this.Ancho||this.Triangulos[T].Y+this.Triangulos[T].Lado<0||this.Triangulos[T].Y>this.Alto){this.Triangulos[T].Iniciar();}}},Triangulo:function(Padre){this.Padre=Padre;this.Posicion=function(Lado){this.Lado=Lado;this.X=Rand()*Lado;this.Y=Rand()*Lado;var Radio=Rand()*Math.PI*2;var Velocidad=Lado*0.01;this.VelocidadX=Math.cos(Radio)*Velocidad;this.VelocidadY=Math.sin(Radio)*Velocidad;this.Avanzar=function(){this.X+=this.VelocidadX;this.Y+=this.VelocidadY;if(this.X<0||this.X>this.Lado){this.VelocidadX*=-1;}
if(this.Y<0||this.Y>this.Lado){this.VelocidadY*=-1;}};};this.Iniciar=function(){this.Lado=Rand(100,50);this.TotalLineas=Rand(5,2);this.Separaciones=Rand(10,5);this.hue=this.Padre.Tick;this.jitter=0.01*this.Lado;var Velocidad=Rand(2,0);var Lado=Rand()<.5;var Radio;if(Rand()<.5){this.X=Rand()*this.Padre.Ancho;this.Y=(Lado)?-this.Lado:this.Padre.Alto+this.Lado;Radio=(Lado)?Rand()*Math.PI:-Rand()*Math.PI;}
else{this.X=Rand()<.5?-this.Lado:this.Padre.Ancho+this.Lado;this.Y=Rand()*this.Padre.Alto;Radio=(Lado)?Rand()*(Math.PI*2):-Rand()*(Math.PI*2);}
this.VelocidadX=Math.cos(Radio)*Velocidad;this.VelocidadY=Math.sin(Radio)*Velocidad;this.Lineas=[];for(var i=0;i<this.TotalLineas;++i){var Linea={p1:new this.Posicion(this.Lado),p2:new this.Posicion(this.Lado)};Linea.p1=new this.Posicion(this.Lado);Linea.p2=new this.Posicion(this.Lado);this.Lineas.push(Linea);}};this.Iniciar();}});
var Banner_MatrixLluviaHexadecimal=function(){if(ObjetoBanner.call(this,"2d")===false){return false;}
this.Caracteres=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];this.Columnas=[];this.TamFuente=10;this.NoPintar=false;this.Columnas=[];var Cols=this.Ancho/this.TamFuente;for(var i=0;i<Cols;i++){this.Columnas[i]=1;}
this.Cargando(false);};Banner_MatrixLluviaHexadecimal.prototype=Object.assign(Object.create(ObjetoBanner.prototype),{constructor:Banner_MatrixLluviaHexadecimal,Nombre:"Matrix lluvia hexadecimal",IdeaOriginal:"thecodeplayer",URL:"http://thecodeplayer.com/walkthrough/matrix-rain-animation-html5-canvas-javascript",NombreURL:"Matrix rain animation",Redimensionar:function(){},Scroll:function(){},Pintar:function(){this.NoPintar=!this.NoPintar;if(this.NoPintar===true)return;this.Context.fillStyle="rgba(49, 46, 53, 0.05)";this.Context.fillRect(0,0,this.Ancho,this.Alto);this.Context.fillStyle="#00FF00";this.Context.font=this.TamFuente+"px arial";for(var i=0;i<this.Columnas.length;i++){var Char=this.Caracteres[RandInt(this.Caracteres.length)];this.Context.fillText(Char,i*this.TamFuente,this.Columnas[i]*this.TamFuente);if(this.Columnas[i]*this.TamFuente>this.Alto&&Rand()>0.975){this.Columnas[i]=0;}
this.Columnas[i]+=1;}}});
var Banner_AdiestramientoCubos3D=function(){if(ObjetoBanner.call(this,"THREE")===false){return false;}
this.TamCubo=0;this.Escena=new THREE.Scene();this.Camara=new THREE.PerspectiveCamera(45,this.Ancho/this.Alto,0.5,10000);this.Camara.position.set(0,2000,2000);this.Escena.add(this.Camara);this.TipoAni=0;this.CharAni=0;var Divisiones=7;var Tam=1000;this.TamCubo=(Tam/(Divisiones/2));this.YBase=(this.TamCubo/2)+this.TamCubo;this.Parrilla=new THREE.GridHelper(Tam,Divisiones,new THREE.Color(0xcccccc),new THREE.Color(0x999999));this.Parrilla.position.y=this.TamCubo;this.GrupoCubos=new THREE.Object3D();this.GrupoCubos.add(this.Parrilla);t=this.TamCubo*0.7;var geometry=new THREE.BoxGeometry(t,t,t);for(var z=-(Divisiones/2);z<(Divisiones/2);z++){for(var x=-(Divisiones/2);x<(Divisiones/2);x++){var Grupo=new THREE.Object3D();var Cubo=new THREE.Mesh(geometry,new THREE.MeshBasicMaterial({color:"rgb(0,50,0)",}));Grupo.Ani=new this.AniColumna(1,1,0);Grupo.add(Cubo);Grupo.position.set((x*this.TamCubo)+(this.TamCubo/2),this.YBase,(z*this.TamCubo)+(this.TamCubo/2));this.CrearMarcoCubo(Grupo,t);this.GrupoCubos.add(Grupo);}}
this.RandAni();this.Escena.add(this.GrupoCubos);var pointLight=new THREE.PointLight(0xFF0000);pointLight.position.set(0,10,0);this.Escena.add(pointLight);this.Cargando(false);};Banner_AdiestramientoCubos3D.prototype=Object.assign(Object.create(ObjetoBanner.prototype),{constructor:Banner_AdiestramientoCubos3D,Nombre:"Adiestramiento de cubos",IdeaOriginal:"devildrey33",URL:"/Lab/Ejemplos/BannerTest/AdiestramientoCubos.html",NombreURL:"Lab : Adiestramiento de cubos",AnimacionCamara:{Rad:0,RadAvance:0,MinRadAvance:-0.005,MaxRadAvance:0.005,RadAvancePositivo:true,Distancia:1900,MinDistancia:1600,MaxDistancia:3100,DistanciaAvance:0.1,MinDistanciaAvance:-3,MaxDistanciaAvance:3,DistanciaAvancePositivo:true},AvanceCamara:function(){if(Rand()<0.01){if(Rand()>0.5){this.AnimacionCamara.RadAvancePositivo=!this.AnimacionCamara.RadAvancePositivo;}
else{this.AnimacionCamara.DistanciaAvancePositivo=!this.AnimacionCamara.DistanciaAvancePositivo;}}
if(this.AnimacionCamara.RadAvancePositivo===true){if(this.AnimacionCamara.RadAvance<this.AnimacionCamara.MaxRadAvance){this.AnimacionCamara.RadAvance+=0.0001;}}
else{if(this.AnimacionCamara.RadAvance>this.AnimacionCamara.MinRadAvance){this.AnimacionCamara.RadAvance-=0.0001;}}
this.AnimacionCamara.Rad+=this.AnimacionCamara.RadAvance;if(this.AnimacionCamara.DistanciaAvancePositivo===true){if(this.AnimacionCamara.DistanciaAvance<this.AnimacionCamara.MaxDistanciaAvance){this.AnimacionCamara.DistanciaAvance+=0.1;}}
else{if(this.AnimacionCamara.DistanciaAvance>this.AnimacionCamara.MinDistanciaAvance){this.AnimacionCamara.DistanciaAvance-=0.1;}}
this.AnimacionCamara.Distancia+=this.AnimacionCamara.DistanciaAvance;if(this.AnimacionCamara.Distancia>this.AnimacionCamara.MaxDistancia){this.AnimacionCamara.Distancia=this.AnimacionCamara.MaxDistancia;}
if(this.AnimacionCamara.Distancia<this.AnimacionCamara.MinDistancia){this.AnimacionCamara.Distancia=this.AnimacionCamara.MinDistancia;}
this.Camara.position.x=this.AnimacionCamara.Distancia*Math.cos(this.AnimacionCamara.Rad);this.Camara.position.z=this.AnimacionCamara.Distancia*Math.sin(this.AnimacionCamara.Rad);this.Camara.lookAt(this.GrupoCubos.position);},Pintar:function(){this.AvanceCamara();var AniTerminada=true;for(var c=1;c<this.GrupoCubos.children.length;c++){var Cubo=this.GrupoCubos.children[c];if(Cubo.Ani.FaseAni===0){if(Cubo.Ani.Retardo<0){Cubo.Ani.Retardo+=16;}
else{if(Cubo.position.y<this.YBase+Cubo.Ani.MaxEscalaY){Cubo.position.y+=Cubo.Ani.Vel;}
else{Cubo.Ani.FaseAni=1;}}}
else if(Cubo.Ani.FaseAni===1){if(Cubo.position.y>this.YBase){Cubo.position.y-=Cubo.Ani.Vel;}
else{Cubo.Ani.FaseAni=2;}}
var col=Math.floor(50+((Cubo.position.y-this.YBase)*0.5));Cubo.children[0].material.color.setStyle("rgb(180, "+col+",0)");if(Cubo.Ani.FaseAni!==2){AniTerminada=false;}}
if(this.TipoAni===4&&AniTerminada===true){var texto="devildrey33";if(this.CharAni<texto.length-1){this.CharAni+=1;this.IniciarAni_Caracter(texto.substr(this.CharAni,1));AniTerminada=false;}
else{this.CharAni=0;}}
this.Context.render(this.Escena,this.Camara);if(AniTerminada===true){this.RandAni();}},CrearMarcoCubo:function(Objeto,Tam){var Grupo=new THREE.Object3D();var Med=Tam/2;var GeoX=new THREE.Geometry();var GeoY=new THREE.Geometry();var GeoZ=new THREE.Geometry();GeoX.vertices.push(new THREE.Vector3(-Med,0,0));GeoX.vertices.push(new THREE.Vector3(Med,0,0));GeoY.vertices.push(new THREE.Vector3(0,-Med,0));GeoY.vertices.push(new THREE.Vector3(0,Med,0));GeoZ.vertices.push(new THREE.Vector3(0,0,-Med));GeoZ.vertices.push(new THREE.Vector3(0,0,Med));Grupo.Material=new THREE.LineBasicMaterial({color:0x333333,opacity:.2,linewidth:.1});var Linea1=new THREE.Line(GeoX,Grupo.Material);var Linea2=new THREE.Line(GeoX,Grupo.Material);var Linea3=new THREE.Line(GeoY,Grupo.Material);var Linea4=new THREE.Line(GeoY,Grupo.Material);Linea1.position.set(0,-Med,Med);Linea2.position.set(0,Med,Med);Linea3.position.set(Med,0,Med);Linea4.position.set(-Med,0,Med);Grupo.add(Linea1);Grupo.add(Linea2);Grupo.add(Linea3);Grupo.add(Linea4);var Linea5=new THREE.Line(GeoX,Grupo.Material);var Linea6=new THREE.Line(GeoX,Grupo.Material);var Linea7=new THREE.Line(GeoY,Grupo.Material);var Linea8=new THREE.Line(GeoY,Grupo.Material);Linea5.position.set(0,-Med,-Med);Linea6.position.set(0,Med,-Med);Linea7.position.set(Med,0,-Med);Linea8.position.set(-Med,0,-Med);Grupo.add(Linea5);Grupo.add(Linea6);Grupo.add(Linea7);Grupo.add(Linea8);var Linea9=new THREE.Line(GeoZ,Grupo.Material);var Linea10=new THREE.Line(GeoZ,Grupo.Material);Linea9.position.set(-Med,Med,0);Linea10.position.set(Med,Med,0);Grupo.add(Linea9);Grupo.add(Linea10);var Linea11=new THREE.Line(GeoZ,Grupo.Material);var Linea12=new THREE.Line(GeoZ,Grupo.Material);Linea11.position.set(-Med,-Med,0);Linea12.position.set(Med,-Med,0);Grupo.add(Linea9);Grupo.add(Linea10);Objeto.add(Grupo);},IniciarAni_Caracter:function(Char){var ColumnasLado=Math.sqrt(this.GrupoCubos.children.length-1);var Inicio=Math.floor((ColumnasLado-5)/2);var cc=0;for(var z=Inicio;z<ColumnasLado-Inicio;z++){for(var x=Inicio;x<ColumnasLado-Inicio;x++){var PosMarcador=1+((z*ColumnasLado)+x);var PosLetra=((z-Inicio)*(ColumnasLado-(Inicio*2)))+(x-Inicio);if(this.Letras5x5[Char][PosLetra]==="x"){this.GrupoCubos.children[PosMarcador].Ani=new this.AniColumna(300,20,0);}
else{this.GrupoCubos.children[PosMarcador].Ani=new this.AniColumna(1,1,0);}}}},IniciarAni_Texto:function(){this.CharAni=0;this.IniciarAni_Caracter('d');},IniciarAni_Filas:function(){var ColumnasLado=Math.sqrt(this.GrupoCubos.children.length-1);var Invertir=false;var rnd=Rand();for(var z=0;z<ColumnasLado;z++){Invertir=!Invertir;for(var x=0;x<ColumnasLado;x++){var Pos=1+((rnd>0.5)?((z*ColumnasLado)+x):((x*ColumnasLado)+z));this.GrupoCubos.children[Pos].Ani=new this.AniColumna(300,15,((Invertir===true)?x*80:(ColumnasLado-x)*80));}}},IniciarAni_Rand:function(){for(var c=1;c<this.GrupoCubos.children.length;c++){this.GrupoCubos.children[c].Ani=new this.AniColumna(Rand(300,100),Rand(15,20),RandInt(500));}},IniciarAni_Ola:function(){var rnd=Rand();var rnd2=Rand();var ColumnasLado=Math.sqrt(this.GrupoCubos.children.length-1);var pos=0;for(var z=0;z<ColumnasLado;z++){for(var x=0;x<ColumnasLado;x++,pos++){var Pos=1+((rnd2>0.5)?((z*ColumnasLado)+x):((x*ColumnasLado)+z));this.GrupoCubos.children[Pos].Ani=new this.AniColumna(Rand(300,250),15,((rnd>0.5)?pos*20:(this.GrupoCubos.children.length-pos)*20));}}},IniciarAni_OlaCentrada:function(){var rnd=Rand();var ColumnasLado=Math.sqrt(this.GrupoCubos.children.length-1);var Max=Math.floor((this.GrupoCubos.children.length-1)/2);this.GrupoCubos.children[this.GrupoCubos.children.length-1].Ani=new this.AniColumna(Rand(300,250),15,Max*20);for(var c=0;c<Max+1;c++){this.GrupoCubos.children[(Max+c)].Ani=new this.AniColumna(Rand(300,250),15,c*20);this.GrupoCubos.children[(Max-c)+1].Ani=new this.AniColumna(Rand(300,250),15,c*20);}},RandAni:function(){if(this.TipoAni!==4){this.TipoAni=RandInt(5);}
else{this.TipoAni=RandInt(4);}
if(this.TipoAni===0){this.IniciarAni_Rand();}
else if(this.TipoAni===1){this.IniciarAni_Ola();}
else if(this.TipoAni===2){this.IniciarAni_OlaCentrada();}
else if(this.TipoAni===3){this.IniciarAni_Filas();}
else if(this.TipoAni===4){(Rand()>0.3)?this.RandAni():this.IniciarAni_Texto();}},AniColumna:function(nMaxEscalaY,nVel,nRetardo){this.MaxEscalaY=nMaxEscalaY;this.Vel=nVel;this.Retardo=-nRetardo;this.FaseAni=0;},Letras5x5:{"d":[" ","x","x"," "," "," ","x"," ","x"," "," ","x"," ","x"," "," ","x"," ","x"," "," ","x","x"," "," "],"e":[" ","x","x","x"," "," ","x"," "," "," "," ","x","x"," "," "," ","x"," "," "," "," ","x","x","x"," "],"v":["x"," "," "," ","x","x"," "," "," ","x"," ","x"," ","x"," "," ","x"," ","x"," "," "," ","x"," "," "],"i":[" ","x","x","x"," "," "," ","x"," "," "," "," ","x"," "," "," "," ","x"," "," "," ","x","x","x"," "],"l":[" ","x"," "," "," "," ","x"," "," "," "," ","x"," "," "," "," ","x"," "," "," "," ","x","x","x"," "],"r":[" ","x","x"," "," "," ","x"," ","x"," "," ","x","x"," "," "," ","x"," ","x"," "," ","x"," ","x"," "],"y":[" ","x"," ","x"," "," ","x"," ","x"," "," "," ","x"," "," "," "," ","x"," "," "," "," ","x"," "," "],"3":[" ","x","x","x"," "," "," "," ","x"," "," "," ","x","x"," "," "," "," ","x"," "," ","x","x","x"," "]}});
var Banner_WormHole=function(){if(ObjetoBanner.call(this,"THREE")===false){return false;}
this.Escena=new THREE.Scene();this.Camara=new THREE.PerspectiveCamera(75,this.Ancho/this.Alto,0.5,1000);this.Camara.position.set(0,(((this.Alto/2)-240)*0.20),500);this.Escena.add(this.Camara);this.H=0;this.H2=0.05;this.TexturasCargadas=0;this.TotalTexturas=2;this.Tunel=[];this.Textura=[];this.TexturaCargada=function(Num,Textura){Textura.wrapT=Textura.wrapS=THREE.RepeatWrapping;Textura.repeat.set(1,2);this.Tunel[Num]=new THREE.Mesh(new THREE.CylinderGeometry((Num*10)+50,(Num*10)+50,1000,16,32,true),new THREE.MeshBasicMaterial({color:0x666666,transparent:true,alphaMap:Textura,side:THREE.BackSide,opacity:(Num===0)?0.3:1}));this.Tunel[Num].rotation.x=90*(Math.PI/180);this.Tunel[Num].position.z=128-Num;this.Escena.add(this.Tunel[Num]);this.Textura[Num]=Textura;this.TexturasCargadas++;if(this.TexturasCargadas===this.TotalTexturas){this.Cargando(false);}};var T1=new THREE.TextureLoader().load('/Web/Graficos/Banner_WormHole11.jpg',this.TexturaCargada.bind(this,0));var T2=new THREE.TextureLoader().load('/Web/Graficos/Banner_WormHole1.2.jpg',this.TexturaCargada.bind(this,1));this.Camara.lookAt(this.Escena.position);};Banner_WormHole.prototype=Object.assign(Object.create(ObjetoBanner.prototype),{constructor:Banner_WormHole,Nombre:"WormHole",IdeaOriginal:"devildrey33",URL:"/Lab/Ejemplos/BannerTest/WormHole.html",NombreURL:"Lab : WormHole",Redimensionar:function(){},Scroll:function(){},MouseMove:function(X,Y){},Pintar:function(){if(typeof(this.Tunel[0])!=='undefined'){this.H+=0.001;if(this.H>1){this.H=0;}
this.Tunel[0].material.color.setHSL(this.H,0.7,0.7);this.Tunel[0].rotation.y+=0.02;this.Textura[0].offset.y-=0.014;}
if(typeof(this.Tunel[1])!=='undefined'){this.H2+=0.001;if(this.H2>1){this.H2=0;}
this.Tunel[1].material.color.setHSL(this.H2,0.7,0.7);this.Tunel[1].rotation.y-=0.017;this.Textura[1].offset.y-=0.019;}
this.Context.render(this.Escena,this.Camara);}});
var Banner_Anillos=function(){if(ObjetoBanner.call(this,"2d")===false){return false;}
this.TotalCirculos=350;this.Circulos=[];this.Circulo=function(Padre){this.Padre=Padre;var CentroX=(this.Padre.Ancho/2);this.CentroY=(this.Padre.Alto/2);this.Angulo=Rand(360);this.Distancia=15+Rand(CentroX+100);this.Tam=Rand(4,1);this.Avance=(Rand(0.008,0.0005)/4)*this.Tam;this.X=CentroX+(this.Distancia*Math.cos(this.Angulo));this.Y=(this.Padre.Alto/2)+(this.Distancia*Math.sin(this.Angulo));this.Color="rgb("+RandInt(255,20)+","+RandInt(255,20)+","+RandInt(255,20)+")";this.Avanzar=function(){if(Padre.Invertir===false){this.Angulo+=this.Avance;}
else{this.Angulo-=this.Avance*1.5;}
this.X=(this.Padre.Ancho/2)+(this.Distancia*Math.cos(this.Angulo));this.Y=(this.Padre.Alto/2)+(this.Distancia*Math.sin(this.Angulo));};};for(var i=0;i<this.TotalCirculos;i++){this.Circulos[i]=new this.Circulo(this);}
this.Context.fillStyle='rgb(49, 46, 53)';this.Context.fillRect(0,0,this.Ancho,this.Alto);this.Cargando(false);};Banner_Anillos.prototype=Object.assign(Object.create(ObjetoBanner.prototype),{constructor:Banner_Anillos,Nombre:"Anillos",IdeaOriginal:"devildrey33",URL:"/Lab/Ejemplos/BannerTest/Anillos.html",NombreURL:"Lab : Anillos",Invertir:false,MouseEnter:function(event){this.Invertir=true;},MouseLeave:function(event){this.Invertir=false;},Pintar:function(){this.Context.fillStyle=(this.Invertir===true)?'rgba(49, 46, 53, 0.02)':'rgba(49, 46, 53, 0.09)';this.Context.fillRect(0,0,this.Ancho,this.Alto);for(var i=0;i<this.TotalCirculos;i++){this.Circulos[i].Avanzar();this.Context.beginPath();this.Context.fillStyle=this.Circulos[i].Color;this.Context.arc(this.Circulos[i].X,this.Circulos[i].Y,this.Circulos[i].Tam,0,2*Math.PI,false);this.Context.fill();}}});
var Banner_Sinusoidal=function(){if(ObjetoBanner.call(this,"2d")===false){return false;}
this.Reiniciar();this.Cargando(false);};Banner_Sinusoidal.prototype=Object.assign(Object.create(ObjetoBanner.prototype),{constructor:Banner_Sinusoidal,Nombre:"Onda Sinusoidal",IdeaOriginal:"devildrey33",URL:"/Lab/Ejemplos/BannerTest/Sinusoidal.html",NombreURL:"Lab : Sinusoidal",Avance2:0,Redimensionar:function(){this.Reiniciar();},Scroll:function(){},MouseMove:function(Evento){},MouseEnter:function(Evento){},MouseLeave:function(Evento){},Circulos:[],CrearCirculos:function(ArrayCirculos){var TotalCirculos=RandInt(7,4);this.Circulos=[];if(typeof(ArrayCirculos)==="undefined"){var cAlpha=1-(TotalCirculos/10);for(var i=0;i<TotalCirculos;i++){this.Circulos.push(new this.Circulo(RandInt((this.Alto/TotalCirculos)-2,15),"rgb("+Math.floor(234*cAlpha)+","+Math.floor(80*cAlpha)+","+Math.floor(78*cAlpha)+")","rgb("+Math.floor(255*cAlpha)+","+Math.floor(155*cAlpha)+","+Math.floor(155*cAlpha)+")"));cAlpha+=0.1;}}
else{var cAlpha=1-(ArrayCirculos.length/10);for(var i=0;i<ArrayCirculos.length;i++){this.Circulos.push(new this.Circulo(ArrayCirculos[i],"rgb("+Math.floor(234*cAlpha)+","+Math.floor(80*cAlpha)+","+Math.floor(78*cAlpha)+")","rgb("+Math.floor(255*cAlpha)+","+Math.floor(155*cAlpha)+","+Math.floor(155*cAlpha)+")"));cAlpha+=0.1;}}
this.Circulos[0].X=this.PosXCirculoCentral;this.Circulos[0].Y=this.Alto/2;this.Circulos[this.Circulos.length-1].Color="rgb(234, 80, 78)";},Circulo:function(Tam,Color,ColorPunto){this.Tam=Tam;this.X=0;this.Y=0;this.Color=Color;this.ColorPunto=ColorPunto;this.Avance=function(Avance,CirculoPadre){this.X=CirculoPadre.X+(Math.cos(Avance)*(CirculoPadre.Tam));this.Y=CirculoPadre.Y+(Math.sin(Avance)*(CirculoPadre.Tam));};},Reiniciar:function(){this.DegradadoTranslucido_Ancho=this.Ancho/8;this.AnchoGrafico=this.Ancho-400;this.PosXCirculoCentral=this.Ancho-200;this.Color="rgb(234, 80, 78)";this.ColorPuntos="rgb(255, 155, 155)";this.DegradadoTranslucido=this.Context.createLinearGradient(0,0,this.DegradadoTranslucido_Ancho,0);this.DegradadoTranslucido.addColorStop(0,"rgba(49, 46, 53, 1)");this.DegradadoTranslucido.addColorStop(1,"rgba(49, 46, 53, 0)");if(Rand()>0.5){this.Velocidad=(Math.PI*2)/180;}
else{this.Velocidad=-((Math.PI*2)/180);}
this.CrearCirculos();this.ImgOnda=new BufferCanvas((this.AnchoGrafico)+360,this.Alto);this.ImgOnda.Context.strokeStyle=this.Color;this.DiametroCirculo=this.ImgOnda.Alto/5;this.ImgOnda.Context.beginPath();this.ImgOnda.Context.moveTo(0,this.ImgOnda.Alto/2);var Avance=0;for(var x=0;x<=(this.AnchoGrafico)+360;x++){Avance+=this.Velocidad;for(var i=1;i<this.Circulos.length;i++){this.Circulos[i].Avance(Avance*i,this.Circulos[i-1]);}
this.ImgOnda.Context.lineTo(x,this.Circulos[this.Circulos.length-1].Y);}
this.ImgOnda.Context.stroke();this.Avance=-Math.floor(this.AnchoGrafico);this.Avance2=0;},Pintar:function(){this.Context.fillStyle="rgba(49, 46, 53, 0.95)";this.Context.fillRect(0,0,this.Ancho,this.Alto);this.Context.strokeStyle="rgb(80, 80, 80)";this.Context.setLineDash([2.5]);this.Context.beginPath();this.Context.moveTo(115,this.Alto/2);this.Context.lineTo(this.PosXCirculoCentral+115,this.Alto/2);this.Context.stroke();this.Context.beginPath();this.Context.moveTo(this.PosXCirculoCentral,(this.Alto/2)-115);this.Context.lineTo(this.PosXCirculoCentral,(this.Alto/2)+115);this.Context.stroke();this.Context.setLineDash([1,0]);this.Avance+=1;if(this.Avance>=360)this.Avance=0;this.Context.drawImage(this.ImgOnda.Canvas,this.Avance,0,this.AnchoGrafico,this.Alto,0,0,this.AnchoGrafico,this.Alto);this.Avance2+=this.Velocidad;this.Context.fillStyle=this.ColorPunto;for(var i=0;i<this.Circulos.length;i++){this.Context.strokeStyle=this.Circulos[i].Color;this.Context.fillStyle=this.Circulos[i].ColorPunto;if(i!==0){this.Circulos[i].Avance(this.Avance2*i,this.Circulos[i-1]);this.Context.beginPath();this.Context.arc(this.Circulos[i].X,this.Circulos[i].Y,2,0,2*Math.PI);this.Context.fill();}
if(i!==this.Circulos.length-1){this.Context.beginPath();this.Context.arc(this.Circulos[i].X,this.Circulos[i].Y,this.Circulos[i].Tam,0,2*Math.PI);this.Context.stroke();}}
this.Context.beginPath();this.Context.moveTo(this.Circulos[i-1].X,this.Circulos[i-1].Y);this.Context.lineTo(this.AnchoGrafico,this.Circulos[i-1].Y);this.Context.stroke();this.Context.beginPath();this.Context.arc(this.AnchoGrafico,this.Circulos[i-1].Y,2.5,0,2*Math.PI);this.Context.fill();this.Context.fillStyle=this.DegradadoTranslucido;this.Context.fillRect(0,0,this.DegradadoTranslucido_Ancho,this.Alto);}});
